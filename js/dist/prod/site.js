(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var ZeroClipboard=require("zeroclipboard");var proj4=require("proj4");var FormatSniffer=require("../format_sniffer/sniffer.js");(function(def){if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=def()}else if(typeof window!=="undefined"){window.Bbox=def()}})(function(){var BboxClass=function(options){options||(options={});if(!this||!(this instanceof BboxClass)){return new BboxClass(options)}this.rsidebar=null;this.lsidebar=null;this.drawControl=null;this.drawnItems=null;this.proj4defs=null;if(typeof L!=="undefined"){this.projdefs={4326:L.CRS.EPSG4326,3857:L.CRS.EPSG3857}}this.currentproj="3857"};BboxClass.prototype.addLayer=function(layer,name,zIndex,on){if(on){layer.setZIndex(zIndex).addTo(map)}else{layer.setZIndex(zIndex)}var ui=document.getElementById("map-ui");var item=document.createElement("li");var link=document.createElement("a");link.href="#";if(on){link.className="active"}else{link.className=""}link.innerHTML=name;link.onclick=function(e){e.preventDefault();e.stopPropagation();if(map.hasLayer(layer)){map.removeLayer(layer);this.className=""}else{map.addLayer(layer);this.className="active"}};item.appendChild(link);ui.appendChild(item)};BboxClass.prototype.formatBounds=function(bounds,proj,tool){var formattedBounds="";var southwest=bounds.getSouthWest();var northeast=bounds.getNorthEast();var xmin=0;var xmin=0;var xmin=0;var xmin=0;if(proj=="4326"){xmin=southwest.lng.toFixed(6);ymin=southwest.lat.toFixed(6);xmax=northeast.lng.toFixed(6);ymax=northeast.lat.toFixed(6)}else{var proj_to_use=null;if(typeof Bbox.projdefs[proj]!=="undefined"){proj_to_use=Bbox.projdefs[proj]}else{Bbox.projdefs[proj]=new L.Proj.CRS(proj,Bbox.proj4defs[proj][1]);proj_to_use=Bbox.projdefs[proj]}southwest=proj_to_use.project(southwest);northeast=proj_to_use.project(northeast);xmin=southwest.x.toFixed(4);ymin=southwest.y.toFixed(4);xmax=northeast.x.toFixed(4);ymax=northeast.y.toFixed(4)}if(tool==="gdal"){formattedBounds=xmin+","+ymin+","+xmax+","+ymax}else{formattedBounds=xmin+" "+ymin+" "+xmax+" "+ymax}return formattedBounds};BboxClass.prototype.formatPoint=function(point,proj,tool){var formattedPoint="";if(proj=="4326"){x=point.lng.toFixed(6);y=point.lat.toFixed(6)}else{var proj_to_use=null;if(typeof Bbox.projdefs[proj]!=="undefined"){proj_to_use=Bbox.projdefs[proj]}else{Bbox.projdefs[proj]=new L.Proj.CRS(proj,Bbox.proj4defs[proj][1]);proj_to_use=Bbox.projdefs[proj]}point=proj_to_use.project(point);x=point.x.toFixed(4);y=point.y.toFixed(4)}if(tool==="gdal"){formattedBounds=x+","+y}else{formattedBounds=x+" "+y}return formattedBounds};BboxClass.prototype.onload_callback=function(){$("#projection").val(Bbox.currentproj);window.map=L.mapbox.map("map","reprojected.g9on3k93").setView([0,0],3);Bbox.rsidebar=L.control.sidebar("rsidebar",{position:"right"});map.addControl(Bbox.rsidebar);Bbox.lsidebar=L.control.sidebar("lsidebar",{position:"left"});map.addControl(Bbox.lsidebar);var crosshairIcon=L.icon({iconUrl:"images/crosshair.png",iconSize:[20,20],iconAnchor:[10,10]});crosshair=new L.marker(map.getCenter(),{icon:crosshairIcon,clickable:false});crosshair.addTo(map);Bbox.drawnItems=new L.FeatureGroup;map.addLayer(Bbox.drawnItems);Bbox.drawControl=new L.Control.Draw({edit:{featureGroup:Bbox.drawnItems}});map.addControl(Bbox.drawControl);var bounds=new L.Rectangle(new L.LatLngBounds([0,0],[0,0]),{fill:false,opacity:1,color:"#000"});bounds.on("bounds-set",function(e){var parent=e.target._container.parentElement;$(parent).append(e.target._container)});map.addLayer(bounds);map.on("draw:created",function(e){Bbox.drawnItems.addLayer(e.layer);bounds.setBounds(Bbox.drawnItems.getBounds());$("#boxbounds").text(formatBounds(bounds.getBounds(),"4326","gdal"));$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));if(!e.geojson&&!(Bbox.drawnItems.getLayers().length==1&&Bbox.drawnItems.getLayers()[0]instanceof L.Marker)){map.fitBounds(bounds.getBounds())}else{if(Bbox.drawnItems.getLayers().length==1&&Bbox.drawnItems.getLayers()[0]instanceof L.Marker){map.panTo(Bbox.drawnItems.getLayers()[0].getLatLng())}}});map.on("draw:deleted",function(e){e.layers.eachLayer(function(l){Bbox.drawnItems.removeLayer(l)});if(Bbox.drawnItems.getLayers().length>0&&!(Bbox.drawnItems.getLayers().length==1&&Bbox.drawnItems.getLayers()[0]instanceof L.Marker)){bounds.setBounds(Bbox.drawnItems.getBounds());$("#boxbounds").text(formatBounds(bounds.getBounds(),"4326","gdal"));$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));map.fitBounds(bounds.getBounds())}else{bounds.setBounds(new L.LatLngBounds([0,0],[0,0]));$("#boxbounds").text(formatBounds(bounds.getBounds(),"4326","gdal"));$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));if(Bbox.drawnItems.getLayers().length==1){map.panTo(Bbox.drawnItems.getLayers()[0].getLatLng())}}});map.on("draw:edited",function(e){bounds.setBounds(Bbox.drawnItems.getBounds());$("#boxbounds").text(formatBounds(bounds.getBounds(),"4326","gdal"));$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));map.fitBounds(bounds.getBounds())});$("#zoomlevel").text(map.getZoom().toString());$("#mapbounds").text(formatBounds(map.getBounds(),"4326","gdal"));$("#mapboundsmerc").text(formatBounds(map.getBounds(),Bbox.currentproj,"gdal"));$("#center").text(formatPoint(map.getCenter(),"4326","gdal"));$("#centermerc").text(formatPoint(map.getCenter(),Bbox.currentproj,"gdal"));$("#boxbounds").text(formatBounds(bounds.getBounds(),"4326","gdal"));$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));$("#mousepos").text(formatPoint(new L.LatLng(0,0),"4326","gdal"));$("#mouseposmerc").text(formatPoint(new L.LatLng(0,0),Bbox.currentproj,"gdal"));map.on("move",function(e){crosshair.setLatLng(map.getCenter())});map.on("mousemove",function(e){$("#mousepos").text(formatPoint(e.latlng,"4326","gdal"));$("#mouseposmerc").text(formatPoint(e.latlng,Bbox.currentproj,"gdal"));$("#mapbounds").text(formatBounds(map.getBounds(),"4326","gdal"));$("#mapboundsmerc").text(formatBounds(map.getBounds(),Bbox.currentproj,"gdal"));$("#center").text(formatPoint(map.getCenter(),"4326","gdal"));$("#centermerc").text(formatPoint(map.getCenter(),Bbox.currentproj,"gdal"))});map.on("zoomend",function(e){$("#zoomlevel").text(map.getZoom().toString());$("#mapbounds").text(formatBounds(map.getBounds(),"4326","gdal"));$("#mapboundsmerc").text(formatBounds(map.getBounds(),Bbox.currentproj,"gdal"))});var zeroFeedback=function(target){$(target).append("<span id='zfeedback'>&nbsp;Copied!&nbsp;</span>");$("#zfeedback").css({"background-color":"#C7C700","font-stye":"bold","border-radius":"15px",padding:"5px","box-shadow":"0px 2px 20px #000"});$(target).animate({opacity:0,top:"-=100"},500);setTimeout(function(){$(target).css("opacity",1);$(target).css("background-color","");$("#zfeedback").remove()},700)};var boxboundclip=new ZeroClipboard($("#boxboundsbtn"),{moviePath:"/swf/ZeroClipboard.swf"});boxboundclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});var boxboundmercclip=new ZeroClipboard($("#boxboundsmercbtn"),{moviePath:"/swf/ZeroClipboard.swf"});boxboundmercclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});var mapboundclip=new ZeroClipboard($("#mapboundsbtn"),{moviePath:"/swf/ZeroClipboard.swf"});mapboundclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});var mapboundmercclip=new ZeroClipboard($("#mapboundsmercbtn"),{moviePath:"/swf/ZeroClipboard.swf"});mapboundmercclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});var centerclip=new ZeroClipboard($("#centerbtn"),{moviePath:"/swf/ZeroClipboard.swf"});centerclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});var centermercclip=new ZeroClipboard($("#centermercbtn"),{moviePath:"/swf/ZeroClipboard.swf"});centermercclip.on("load",function(client){client.on("complete",function(client,args){zeroFeedback(client.htmlBridge)})});$("#create-geojson").on("click",function(){Bbox.rsidebar.show()});$("#geolocation").on("click",function(){map.locate({setView:true,maxZoom:8})});$("button#add").on("click",function(evt){var sniffer=FormatSniffer({data:$(".leaflet-sidebar textarea").val()});var is_valid=sniffer.sniff();if(is_valid){Bbox.rsidebar.hide();map.fitBounds(bounds.getBounds())}});$("button#clear").on("click",function(evt){$(".leaflet-sidebar textarea").val("")});var tiles=new L.tileLayer("/images/tile.png",{});Bbox.self.addLayer(tiles,"Tile Grid",10,false);$.getJSON("proj/proj4defs.json").done(function(data){Bbox.proj4defs=data;var autocompdata=[];$.each(data,function(key,val){autocompdata.push({label:key+"-"+val[0],value:key})});$("#projection").autocomplete({source:autocompdata,minLength:3,select:function(event,ui){$("#projlabel").text("EPSG:"+ui.item.value+" - "+Bbox.proj4defs[ui.item.value][0]);Bbox.currentproj=ui.item.value;$("#boxboundsmerc").text(formatBounds(bounds.getBounds(),Bbox.currentproj,"gdal"));$("#mouseposmerc").text(formatPoint(new L.LatLng(0,0),Bbox.currentproj,"gdal"));$("#mapboundsmerc").text(formatBounds(map.getBounds(),Bbox.currentproj,"gdal"));$("#centermerc").text(formatPoint(map.getCenter(),Bbox.currentproj,"gdal"))}}).val("3857");$("#wgslabel").text("EPSG:4326 - "+Bbox.proj4defs["4326"][0]);$("#projlabel").text("EPSG:3857 - "+Bbox.proj4defs["3857"][0])}).fail(function(jqxhr,textStatus,error){var err=textStatus+", "+error;console.log("Request Failed: "+err)})};return new BboxClass});if(typeof L!=="undefined"){L.Rectangle.prototype.setBounds=function(latLngBounds){this.setLatLngs(this._boundsToLatLngs(latLngBounds));this.fire("bounds-set")}}},{"../format_sniffer/sniffer.js":2,proj4:21,zeroclipboard:53}],2:[function(require,module,exports){(function(def){if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=def()}})(function(){"use strict";var FormatSniffer=function(options){options||(options={});if(!this||!(this instanceof FormatSniffer)){return new FormatSniffer(options)}this.regExes={ogrinfoExtent:/Extent\:\s\((.*)\)/,bbox:/^\(([\s|\-|0-9]*\.[0-9]*,[\s|\-|0-9]*\.[0-9]*,[\s|\-|0-9]*\.[0-9]*,[\s|\-|0-9]*\.[0-9|\s]*)\)$/};this.data=options.data||"";this.parse_type=null};FormatSniffer.prototype.sniff=function(){return this._sniffFormat()};FormatSniffer.prototype._is_ogrinfo=function(){var match=this.regExes.ogrinfoExtent.exec(this.data.trim());var extent=[];if(match){var pairs=match[1].split(") - (");for(var indx=0;indx<pairs.length;indx++){var coords=pairs[indx].trim().split(",");extent=extent.concat([parseFloat(coords[0].trim()),parseFloat(coords[1].trim())])}}this.parse_type="ogrinfo";return extent};FormatSniffer.prototype._is_normal_bbox=function(){var match=this.regExes.bbox.exec(this.data.trim());var extent=[];if(match){var bbox=match[1].split(",");for(var indx=0;indx<bbox.length;indx++){var coord=bbox[indx].trim();extent=extent.concat([parseFloat(coord)])}}this.parse_type="bbox";return extent};FormatSniffer.prototype._is_geojson=function(){try{var json=JSON.parse(this.data);var parsed_data=new L.geoJson(json)}catch(err){return null}this.parse_type="geojson";return parsed_data};FormatSniffer.prototype._is_wkt=function(){if(this.data===""){throw new Error("empty -- nothing to parse")}try{var parsed_data=new Wkt.Wkt(this.data)}catch(err){return null}this.parse_type="wkt";return parsed_data};FormatSniffer.prototype._sniffFormat=function(){var parsed_data=null;var fail=false;try{var next=true;parsed_data=this._is_ogrinfo();if(parsed_data.length>0){next=false}if(next){parsed_data=this._is_normal_bbox();if(parsed_data.length>0)next=false}if(next){parsed_data=this._is_geojson();if(parsed_data)next=false}if(next){parsed_data=this._is_wkt();if(parsed_data)next=false}if(next){fail=true;throw{name:"NoTypeMatchError",message:"The data is not a recognized format:\n 1. ogrinfo extent output\n 2. bbox as (xMin,yMin,xMax,yMax )\n 3. GeoJSON\n 4. WKT\n\n "}}}catch(err){alert("Your paste is not parsable:\n"+err.message);fail=true}if(!fail){this._formatHandler[this.parse_type].call(this._formatHandler,parsed_data)}return fail?false:true};FormatSniffer.prototype._formatHandler={coerce:function(lyr,type_obj){var event_obj={layer:lyr,layerType:null};if(/point/i.test(type_obj)){event_obj.layerType="marker"}else if(/linestring/i.test(type_obj)){event_obj.layerType="polyline"}else if(/polygon/i.test(type_obj)){event_obj.layerType="polygon"}return event_obj},reduce_layers:function(lyr){var lyr_parts=[];if(typeof lyr["getLayers"]==="undefined"){return[lyr]}else{var all_layers=lyr.getLayers();for(var i=0;i<all_layers.length;i++){lyr_parts=lyr_parts.concat(this.reduce_layers(all_layers[i]))}}return lyr_parts},get_leaflet_bounds:function(data){var sw=[data[1],data[0]];var ne=[data[3],data[2]];return new L.LatLngBounds(sw,ne)},wkt:function(data){var wkt_layer=data.construct[data.type].call(data);var all_layers=this.reduce_layers(wkt_layer);for(var indx=0;indx<all_layers.length;indx++){var lyr=all_layers[indx];var evt=this.coerce(lyr,data.type);map.fire("draw:created",evt)}},geojson:function(geojson_layer){var all_layers=this.reduce_layers(geojson_layer);for(var indx=0;indx<all_layers.length;indx++){var lyr=all_layers[indx];var geom_type=geojson_layer.getLayers()[0].feature.geometry.type;var evt=this.coerce(lyr,geom_type);map.fire("draw:created",evt)}},ogrinfo:function(data){var lBounds=this.get_leaflet_bounds(data);var lyr=new L.Rectangle(lBounds);var evt=this.coerce(lyr,"polygon");map.fire("draw:created",evt)},bbox:function(data){var lBounds=this.get_leaflet_bounds(data);var lyr=new L.Rectangle(lBounds);var evt=this.coerce(lyr,"polygon");map.fire("draw:created",evt)}};return FormatSniffer})},{}],3:[function(require,module,exports){window.Bbox=require("./bbox");window.BboxTestRunner=require("./test/test.runner.js");window.onload=Bbox.onload_callback},{"./bbox":1,"./test/test.runner.js":4}],4:[function(require,module,exports){var TEST_DATA=require("./testdata.json");var Bbox=require("../bbox");(function(definition){if(typeof module!=="undefined"&&typeof module.exports!=="undefined"){module.exports=definition()}else if(typeof window==="object"){window.BBOX_T=definition()}})(function(){"use strict";var TestRunner=function(options){options||(options={});if(!this||!(this instanceof TestRunner)){return new TestRunner(options)}this.test_url=options.url||"";this.test_data=TEST_DATA};TestRunner.prototype.global_setup=function(){this.run_this_mother(this.test_data)};TestRunner.prototype.single_setup=function(){this.get_layer_count()};TestRunner.prototype.tear_down=function(){if(this._draw_delete_handler){this._draw_delete_handler.off("draw:deleted")}};TestRunner.prototype.run_this_mother=function(json_data){for(var key in json_data){console.log("[ RUNNING ]: test "+json_data[key]["type"]+"->"+"simple="+json_data[key]["simple"]);var data=json_data[key]["data"];if(json_data[key]["type"]==="geojson"){data=JSON.stringify(data)}this.single_setup();this.test_parsing(data,json_data);this.test_add2map(json_data);this.test_deletable(json_data);this.tear_down()}};TestRunner.prototype.test_deletable=function(identifier){var toolbar=null;for(var key in Bbox.drawControl._toolbars){var tbar=Bbox.drawControl._toolbars[key];if(!(tbar instanceof L.EditToolbar)){continue}toolbar=tbar}this._draw_delete_handler=map.on("draw:deleted",function(e){try{e.layers.eachLayer(function(l){Bbox.drawnItems.removeLayer(l)});console.warn("[ PASSED ]: test_deletable")}catch(err){console.error("[ DELETE TEST FAIL ]: ",err.message,identifier)}});if(!toolbar._activeMode){toolbar._modes["remove"].button.click()}for(var indx in toolbar.options["featureGroup"]._layers){try{var lyr=toolbar.options["featureGroup"]._layers[indx];lyr.fire("click")}catch(err){console.error("[ DELETE TEST FAIL ]: ",err.message,identifier)}}$('a[title="Save changes."]')[0].click()};TestRunner.prototype.test_add2map=function(identifier){var current_num=Object.keys(map._layers).length;if(current_num<=this.num_layers_before_parse){console.error("[ ADD2MAP TEST FAIL ]: ",identifier)}else{console.warn("[ PASSED ]: test_add2map")}};TestRunner.prototype.get_layer_count=function(){this.num_layers_before_parse=Object.keys(map._layers).length};TestRunner.prototype.test_parsing=function(data,identifier){var is_valid=FormatSniffer({data:data}).sniff();if(!is_valid){console.error("[ PARSE TEST FAIL ]: ",identifier)}else{console.warn("[ PASSED ]: test_parsing")}};return TestRunner})},{"../bbox":1,"./testdata.json":5}],5:[function(require,module,exports){module.exports=[{type:"wkt",simple:true,data:"POLYGON ((35 10, 45 45, 15 40, 10 20, 35 10), (20 30, 35 35, 30 20, 20 30))"},{type:"wkt",simple:false,data:"MULTIPOLYGON (((30 20, 45 40, 10 40, 30 20)), ((15 5, 40 10, 10 20, 5 10, 15 5)))"},{type:"geojson",simple:true,data:{type:"Feature",properties:{party:"Republican"},geometry:{type:"Polygon",coordinates:[[[-104.05,48.99],[-97.22,48.98],[-96.58,45.94],[-104.03,45.94],[-104.05,48.99]]]}}},{type:"geojson",simple:false,data:{type:"Feature",geometry:{type:"MultiPolygon",coordinates:[[[[101.2,1.2],[101.8,1.2],[101.8,1.8],[101.2,1.8],[101.2,1.2]],[[101.2,1.2],[101.3,1.2],[101.3,1.3],[101.2,1.3],[101.2,1.2]],[[101.6,1.4],[101.7,1.4],[101.7,1.5],[101.6,1.5],[101.6,1.4]],[[101.5,1.6],[101.6,1.6],[101.6,1.7],[101.5,1.7],[101.5,1.6]]],[[[100,0],[101,0],[101,1],[100,1],[100,0]],[[100.35,.35],[100.65,.35],[100.65,.65],[100.35,.65],[100.35,.35]]]]},properties:{}}},{type:"ogrinfo",simple:true,data:"Extent: (-117.623198, 23.208206) - (-82.322650, 46.182910)"},{type:"bbox",simple:true,data:"(  -117.623198,     23.208206,    -82.322650,46.182910          )"}]},{}],6:[function(require,module,exports){var mgrs=require("./mgrs");function Point(x,y,z){if(!(this instanceof Point)){return new Point(x,y,z)}if(Array.isArray(x)){this.x=x[0];this.y=x[1];this.z=x[2]||0}else if(typeof x==="object"){this.x=x.x;this.y=x.y;this.z=x.z||0}else if(typeof x==="string"&&typeof y==="undefined"){var coords=x.split(",");this.x=parseFloat(coords[0],10);this.y=parseFloat(coords[1],10);this.z=parseFloat(coords[2],10)||0}else{this.x=x;this.y=y;this.z=z||0}this.clone=function(){return new Point(this.x,this.y,this.z)};this.toArray=function(){if(this.z){return[this.x,this.y,this.z]}else{return[this.x,this.y]}};this.toString=function(){if(this.z){return"x="+this.x+",y="+this.y+",z="+this.z}else{return"x="+this.x+",y="+this.y}};this.toShortString=function(){if(this.z){return this.x+","+this.y+","+this.z}else{return this.x+","+this.y}}}Point.fromMGRS=function(mgrsStr){var llbbox=mgrs.inverse(mgrsStr);return new Point((llbbox[2]+llbbox[0])/2,(llbbox[3]+llbbox[1])/2)};Point.prototype.toMGRS=function(accuracy){return mgrs.forward({lon:this.x,lat:this.y},accuracy)};module.exports=Point},{"./mgrs":22}],7:[function(require,module,exports){var extend=require("./extend");var common=require("./common");var defs=require("./defs");var constants=require("./constants/index");var datum=require("./datum");var projections=require("./projections/index");var wkt=require("./wkt");var projStr=require("./projString");function Projection(srsCode){if(!(this instanceof Projection)){return new Projection(srsCode)}this.srsCodeInput=srsCode;this.x0=0;this.y0=0;var obj;if(typeof srsCode==="string"){if(srsCode in defs){this.deriveConstants(defs[srsCode]);extend(this,defs[srsCode])}else if(srsCode.indexOf("GEOGCS")>=0||srsCode.indexOf("GEOCCS")>=0||srsCode.indexOf("PROJCS")>=0||srsCode.indexOf("LOCAL_CS")>=0){obj=wkt(srsCode);this.deriveConstants(obj);extend(this,obj)}else if(srsCode[0]==="+"){obj=projStr(srsCode);this.deriveConstants(obj);extend(this,obj)}}else{this.deriveConstants(srsCode);extend(this,srsCode)}this.initTransforms(this.projName)}Projection.projections=projections;Projection.projections.start();Projection.prototype={initTransforms:function(projName){var ourProj=Projection.projections.get(projName);if(ourProj){extend(this,ourProj);this.init()}else{throw"unknown projection "+projName}},deriveConstants:function(self){if(self.nadgrids&&self.nadgrids.length===0){self.nadgrids=null}if(self.nadgrids){self.grids=self.nadgrids.split(",");var g=null,l=self.grids.length;if(l>0){for(var i=0;i<l;i++){g=self.grids[i];var fg=g.split("@");if(fg[fg.length-1]===""){continue}self.grids[i]={mandatory:fg.length===1,name:fg[fg.length-1],grid:constants.grids[fg[fg.length-1]]};if(self.grids[i].mandatory&&!self.grids[i].grid){}}}}if(self.datumCode&&self.datumCode!=="none"){var datumDef=constants.Datum[self.datumCode];if(datumDef){self.datum_params=datumDef.towgs84?datumDef.towgs84.split(","):null;self.ellps=datumDef.ellipse;self.datumName=datumDef.datumName?datumDef.datumName:self.datumCode}}if(!self.a){var ellipse=constants.Ellipsoid[self.ellps]?constants.Ellipsoid[self.ellps]:constants.Ellipsoid.WGS84;extend(self,ellipse)}if(self.rf&&!self.b){self.b=(1-1/self.rf)*self.a}if(self.rf===0||Math.abs(self.a-self.b)<common.EPSLN){self.sphere=true;self.b=self.a}self.a2=self.a*self.a;self.b2=self.b*self.b;self.es=(self.a2-self.b2)/self.a2;self.e=Math.sqrt(self.es);if(self.R_A){self.a*=1-self.es*(common.SIXTH+self.es*(common.RA4+self.es*common.RA6));self.a2=self.a*self.a;self.b2=self.b*self.b;self.es=0}self.ep2=(self.a2-self.b2)/self.b2;if(!self.k0){self.k0=1}if(!self.axis){self.axis="enu"}self.datum=datum(self)}};module.exports=Projection},{"./common":9,"./constants/index":14,"./datum":16,"./defs":18,"./extend":19,"./projString":23,"./projections/index":32,"./wkt":52}],8:[function(require,module,exports){module.exports=function(crs,denorm,point){var xin=point.x,yin=point.y,zin=point.z||0;var v,t,i;for(i=0;i<3;i++){if(denorm&&i===2&&point.z===undefined){continue}if(i===0){v=xin;t="x"}else if(i===1){v=yin;t="y"}else{v=zin;t="z"}switch(crs.axis[i]){case"e":point[t]=v;break;case"w":point[t]=-v;break;case"n":point[t]=v;break;case"s":point[t]=-v;break;case"u":if(point[t]!==undefined){point.z=v}break;case"d":if(point[t]!==undefined){point.z=-v}break;default:return null}}return point}},{}],9:[function(require,module,exports){exports.PI=3.141592653589793;exports.HALF_PI=1.5707963267948966;exports.TWO_PI=6.283185307179586;exports.FORTPI=.7853981633974483;exports.R2D=57.29577951308232;exports.D2R=.017453292519943295;exports.SEC_TO_RAD=484813681109536e-20;exports.EPSLN=1e-10;exports.MAX_ITER=20;exports.COS_67P5=.3826834323650898;exports.AD_C=1.0026;exports.PJD_UNKNOWN=0;exports.PJD_3PARAM=1;exports.PJD_7PARAM=2;exports.PJD_GRIDSHIFT=3;exports.PJD_WGS84=4;exports.PJD_NODATUM=5;exports.SRS_WGS84_SEMIMAJOR=6378137;exports.SRS_WGS84_ESQUARED=.006694379990141316;exports.SIXTH=.16666666666666666;exports.RA4=.04722222222222222;exports.RA6=.022156084656084655;exports.RV4=.06944444444444445;exports.RV6=.04243827160493827;exports.msfnz=function(eccent,sinphi,cosphi){var con=eccent*sinphi;return cosphi/Math.sqrt(1-con*con)};exports.tsfnz=function(eccent,phi,sinphi){var con=eccent*sinphi;var com=.5*eccent;con=Math.pow((1-con)/(1+con),com);return Math.tan(.5*(this.HALF_PI-phi))/con};exports.phi2z=function(eccent,ts){var eccnth=.5*eccent;var con,dphi;var phi=this.HALF_PI-2*Math.atan(ts);for(var i=0;i<=15;i++){con=eccent*Math.sin(phi);dphi=this.HALF_PI-2*Math.atan(ts*Math.pow((1-con)/(1+con),eccnth))-phi;phi+=dphi;if(Math.abs(dphi)<=1e-10){return phi}}return-9999};exports.qsfnz=function(eccent,sinphi){var con;if(eccent>1e-7){con=eccent*sinphi;return(1-eccent*eccent)*(sinphi/(1-con*con)-.5/eccent*Math.log((1-con)/(1+con)))}else{return 2*sinphi}};exports.iqsfnz=function(eccent,q){var temp=1-(1-eccent*eccent)/(2*eccent)*Math.log((1-eccent)/(1+eccent));if(Math.abs(Math.abs(q)-temp)<1e-6){if(q<0){return-1*exports.HALF_PI}else{return exports.HALF_PI}}var phi=Math.asin(.5*q);var dphi;var sin_phi;var cos_phi;var con;for(var i=0;i<30;i++){sin_phi=Math.sin(phi);cos_phi=Math.cos(phi);con=eccent*sin_phi;dphi=Math.pow(1-con*con,2)/(2*cos_phi)*(q/(1-eccent*eccent)-sin_phi/(1-con*con)+.5/eccent*Math.log((1-con)/(1+con)));phi+=dphi;if(Math.abs(dphi)<=1e-10){return phi}}return NaN};exports.asinz=function(x){if(Math.abs(x)>1){x=x>1?1:-1}return Math.asin(x)};exports.e0fn=function(x){return 1-.25*x*(1+x/16*(3+1.25*x))};exports.e1fn=function(x){return.375*x*(1+.25*x*(1+.46875*x))};exports.e2fn=function(x){return.05859375*x*x*(1+.75*x)};exports.e3fn=function(x){return x*x*x*(35/3072)};exports.mlfn=function(e0,e1,e2,e3,phi){return e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)};exports.imlfn=function(ml,e0,e1,e2,e3){var phi;var dphi;phi=ml/e0;for(var i=0;i<15;i++){dphi=(ml-(e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)))/(e0-2*e1*Math.cos(2*phi)+4*e2*Math.cos(4*phi)-6*e3*Math.cos(6*phi));phi+=dphi;if(Math.abs(dphi)<=1e-10){return phi}}return NaN};exports.srat=function(esinp,exp){return Math.pow((1-esinp)/(1+esinp),exp)};exports.sign=function(x){if(x<0){return-1}else{return 1}};exports.adjust_lon=function(x){x=Math.abs(x)<this.PI?x:x-this.sign(x)*this.TWO_PI;return x};exports.adjust_lat=function(x){x=Math.abs(x)<this.HALF_PI?x:x-this.sign(x)*this.PI;return x};exports.latiso=function(eccent,phi,sinphi){if(Math.abs(phi)>this.HALF_PI){return Number.NaN}if(phi===this.HALF_PI){return Number.POSITIVE_INFINITY}if(phi===-1*this.HALF_PI){return Number.NEGATIVE_INFINITY}var con=eccent*sinphi;return Math.log(Math.tan((this.HALF_PI+phi)/2))+eccent*Math.log((1-con)/(1+con))/2};exports.fL=function(x,L){return 2*Math.atan(x*Math.exp(L))-this.HALF_PI};exports.invlatiso=function(eccent,ts){var phi=this.fL(1,ts);var Iphi=0;var con=0;do{Iphi=phi;con=eccent*Math.sin(Iphi);phi=this.fL(Math.exp(eccent*Math.log((1+con)/(1-con))/2),ts)}while(Math.abs(phi-Iphi)>1e-12);return phi};exports.sinh=function(x){var r=Math.exp(x);r=(r-1/r)/2;return r};exports.cosh=function(x){var r=Math.exp(x);r=(r+1/r)/2;return r};exports.tanh=function(x){var r=Math.exp(x);r=(r-1/r)/(r+1/r);return r};exports.asinh=function(x){var s=x>=0?1:-1;return s*Math.log(Math.abs(x)+Math.sqrt(x*x+1))};exports.acosh=function(x){return 2*Math.log(Math.sqrt((x+1)/2)+Math.sqrt((x-1)/2))};exports.atanh=function(x){return Math.log((x-1)/(x+1))/2};exports.gN=function(a,e,sinphi){var temp=e*sinphi;return a/Math.sqrt(1-temp*temp)};exports.pj_enfn=function(es){var en=[];en[0]=this.C00-es*(this.C02+es*(this.C04+es*(this.C06+es*this.C08)));en[1]=es*(this.C22-es*(this.C04+es*(this.C06+es*this.C08)));var t=es*es;en[2]=t*(this.C44-es*(this.C46+es*this.C48));t*=es;en[3]=t*(this.C66-es*this.C68);en[4]=t*es*this.C88;return en};exports.pj_mlfn=function(phi,sphi,cphi,en){cphi*=sphi;sphi*=sphi;return en[0]*phi-cphi*(en[1]+sphi*(en[2]+sphi*(en[3]+sphi*en[4])))};exports.pj_inv_mlfn=function(arg,es,en){var k=1/(1-es);var phi=arg;for(var i=exports.MAX_ITER;i;--i){var s=Math.sin(phi);var t=1-es*s*s;t=(this.pj_mlfn(phi,s,Math.cos(phi),en)-arg)*t*Math.sqrt(t)*k;phi-=t;if(Math.abs(t)<exports.EPSLN){return phi}}return phi};exports.nadInterBreakout=function(indx,frct,letter,number,ct){var inx;if(indx[letter]<0){if(!(indx[letter]===-1&&frct[letter]>.99999999999)){return false}indx[letter]++;frct[letter]=0}else{inx=indx[letter]+1;if(inx>=ct.lim[number]){if(!(inx===ct.lim[number]&&frct[letter]<1e-11)){return false}if(letter==="x"){indx[letter]--}else{indx[letter]++}frct[letter]=1}}return[indx,frct]};exports.nad_intr=function(pin,ct){var t={x:(pin.x-1e-7)/ct.del[0],y:(pin.y-1e-7)/ct.del[1]};var indx={x:Math.floor(t.x),y:Math.floor(t.y)};var frct={x:t.x-1*indx.x,y:t.y-1*indx.y};var val={x:Number.NaN,y:Number.NaN};var temp=exports.nadInterBreakout(indx,frct,"x",0,ct);if(temp){indx=temp[0];frct=temp[1]}else{return val}temp=exports.nadInterBreakout(indx,frct,"y",1,ct);if(temp){indx=temp[0];frct=temp[1]}else{return val}var inx=indx.y*ct.lim[0]+indx.x;var f00={x:ct.cvs[inx][0],y:ct.cvs[inx][1]};inx++;var f10={x:ct.cvs[inx][0],y:ct.cvs[inx][1]};inx+=ct.lim[0];var f11={x:ct.cvs[inx][0],y:ct.cvs[inx][1]};inx--;var f01={x:ct.cvs[inx][0],y:ct.cvs[inx][1]};var m11=frct.x*frct.y,m10=frct.x*(1-frct.y),m00=(1-frct.x)*(1-frct.y),m01=(1-frct.x)*frct.y;val.x=m00*f00.x+m10*f10.x+m01*f01.x+m11*f11.x;val.y=m00*f00.y+m10*f10.y+m01*f01.y+m11*f11.y;return val};exports.inverseNadCvt=function(t,val,tb,ct){if(isNaN(t.x)){return val}t.x=tb.x+t.x;t.y=tb.y-t.y;var i=9,tol=1e-12;var dif,del;do{del=exports.nad_intr(t,ct);if(isNaN(del.x)){this.reportError("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}dif={x:t.x-del.x-tb.x,y:t.y+del.y-tb.y};t.x-=dif.x;t.y-=dif.y}while(i--&&Math.abs(dif.x)>tol&&Math.abs(dif.y)>tol);if(i<0){this.reportError("Inverse grid shift iterator failed to converge.");return val}val.x=exports.adjust_lon(t.x+ct.ll[0]);val.y=t.y+ct.ll[1];return val};exports.nad_cvt=function(pin,inverse,ct){var val={x:Number.NaN,y:Number.NaN};if(isNaN(pin.x)){return val}var tb={x:pin.x,y:pin.y};tb.x-=ct.ll[0];tb.y-=ct.ll[1];tb.x=exports.adjust_lon(tb.x-exports.PI)+exports.PI;var t=exports.nad_intr(tb,ct);if(inverse){return exports.inverseNadCvt(t,val,tb,ct)}else{if(!isNaN(t.x)){val.x=pin.x-t.x;val.y=pin.y+t.y}}return val};exports.C00=1;exports.C02=.25;exports.C04=.046875;exports.C06=.01953125;exports.C08=.01068115234375;exports.C22=.75;exports.C44=.46875;exports.C46=.013020833333333334;exports.C48=.007120768229166667;exports.C66=.3645833333333333;exports.C68=.005696614583333333;exports.C88=.3076171875},{}],10:[function(require,module,exports){exports.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};exports.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};exports.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};exports.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};exports.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};exports.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};exports.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};exports.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"};exports.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};exports.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};exports.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};exports.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};exports.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};exports.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};exports.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"}},{}],11:[function(require,module,exports){exports.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};exports.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};exports.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};exports.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};exports.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};exports.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};exports.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};exports.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};
exports.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};exports.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};exports.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};exports.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};exports.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};exports.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};exports.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};exports.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};exports.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};exports.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};exports.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};exports.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};exports.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};exports.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"};exports.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};exports.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};exports.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};exports.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};exports.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};exports.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};exports.hough={a:6378270,rf:297,ellipseName:"Hough"};exports.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};exports.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};exports.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};exports.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};exports.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};exports.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};exports.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};exports.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};exports.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};exports.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"};exports.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};exports.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};exports.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};exports.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],12:[function(require,module,exports){exports.greenwich=0;exports.lisbon=-9.131906111111;exports.paris=2.337229166667;exports.bogota=-74.080916666667;exports.madrid=-3.687938888889;exports.rome=12.452333333333;exports.bern=7.439583333333;exports.jakarta=106.807719444444;exports.ferro=-17.666666666667;exports.brussels=4.367975;exports.stockholm=18.058277777778;exports.athens=23.7163375;exports.oslo=10.722916666667},{}],13:[function(require,module,exports){exports.null={ll:[-3.14159265,-1.57079633],del:[3.14159265,1.57079633],lim:[3,3],count:9,cvs:[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0]]}},{}],14:[function(require,module,exports){exports.PrimeMeridian=require("./PrimeMeridian");exports.Ellipsoid=require("./Ellipsoid");exports.Datum=require("./Datum");exports.Datum.OSB36=exports.Datum.OSGB36;exports.grids=require("./grids")},{"./Datum":10,"./Ellipsoid":11,"./PrimeMeridian":12,"./grids":13}],15:[function(require,module,exports){var point=require("./Point");var proj=require("./Proj");var transform=require("./transform");var wgs84=proj("WGS84");function transformer(from,to,coords){var transformedArray;if(Array.isArray(coords)){transformedArray=transform(from,to,point(coords));if(coords.length===3){return[transformedArray.x,transformedArray.y,transformedArray.z]}else{return[transformedArray.x,transformedArray.y]}}else{return transform(from,to,coords)}}function checkProj(item){if(item instanceof proj){return item}if(item.oProj){return item.oProj}return proj(item)}function proj4(fromProj,toProj,coord){fromProj=checkProj(fromProj);var single=false;var obj;if(typeof toProj==="undefined"){toProj=fromProj;fromProj=wgs84;single=true}else if(typeof toProj.x!=="undefined"||Array.isArray(toProj)){coord=toProj;toProj=fromProj;fromProj=wgs84;single=true}toProj=checkProj(toProj);if(coord){return transformer(fromProj,toProj,coord)}else{obj={forward:function(coords){return transformer(fromProj,toProj,coords)},inverse:function(coords){return transformer(toProj,fromProj,coords)}};if(single){obj.oProj=toProj}return obj}}module.exports=proj4},{"./Point":6,"./Proj":7,"./transform":50}],16:[function(require,module,exports){var common=require("./common");var datum=function(proj){if(!(this instanceof datum)){return new datum(proj)}this.datum_type=common.PJD_WGS84;if(!proj){return}if(proj.datumCode&&proj.datumCode==="none"){this.datum_type=common.PJD_NODATUM}if(proj.datum_params){for(var i=0;i<proj.datum_params.length;i++){proj.datum_params[i]=parseFloat(proj.datum_params[i])}if(proj.datum_params[0]!==0||proj.datum_params[1]!==0||proj.datum_params[2]!==0){this.datum_type=common.PJD_3PARAM}if(proj.datum_params.length>3){if(proj.datum_params[3]!==0||proj.datum_params[4]!==0||proj.datum_params[5]!==0||proj.datum_params[6]!==0){this.datum_type=common.PJD_7PARAM;proj.datum_params[3]*=common.SEC_TO_RAD;proj.datum_params[4]*=common.SEC_TO_RAD;proj.datum_params[5]*=common.SEC_TO_RAD;proj.datum_params[6]=proj.datum_params[6]/1e6+1}}}this.datum_type=proj.grids?common.PJD_GRIDSHIFT:this.datum_type;this.a=proj.a;this.b=proj.b;this.es=proj.es;this.ep2=proj.ep2;this.datum_params=proj.datum_params;if(this.datum_type===common.PJD_GRIDSHIFT){this.grids=proj.grids}};datum.prototype={compare_datums:function(dest){if(this.datum_type!==dest.datum_type){return false}else if(this.a!==dest.a||Math.abs(this.es-dest.es)>5e-11){return false}else if(this.datum_type===common.PJD_3PARAM){return this.datum_params[0]===dest.datum_params[0]&&this.datum_params[1]===dest.datum_params[1]&&this.datum_params[2]===dest.datum_params[2]}else if(this.datum_type===common.PJD_7PARAM){return this.datum_params[0]===dest.datum_params[0]&&this.datum_params[1]===dest.datum_params[1]&&this.datum_params[2]===dest.datum_params[2]&&this.datum_params[3]===dest.datum_params[3]&&this.datum_params[4]===dest.datum_params[4]&&this.datum_params[5]===dest.datum_params[5]&&this.datum_params[6]===dest.datum_params[6]}else if(this.datum_type===common.PJD_GRIDSHIFT||dest.datum_type===common.PJD_GRIDSHIFT){return this.nadgrids===dest.nadgrids}else{return true}},geodetic_to_geocentric:function(p){var Longitude=p.x;var Latitude=p.y;var Height=p.z?p.z:0;var X;var Y;var Z;var Error_Code=0;var Rn;var Sin_Lat;var Sin2_Lat;var Cos_Lat;if(Latitude<-common.HALF_PI&&Latitude>-1.001*common.HALF_PI){Latitude=-common.HALF_PI}else if(Latitude>common.HALF_PI&&Latitude<1.001*common.HALF_PI){Latitude=common.HALF_PI}else if(Latitude<-common.HALF_PI||Latitude>common.HALF_PI){return null}if(Longitude>common.PI){Longitude-=2*common.PI}Sin_Lat=Math.sin(Latitude);Cos_Lat=Math.cos(Latitude);Sin2_Lat=Sin_Lat*Sin_Lat;Rn=this.a/Math.sqrt(1-this.es*Sin2_Lat);X=(Rn+Height)*Cos_Lat*Math.cos(Longitude);Y=(Rn+Height)*Cos_Lat*Math.sin(Longitude);Z=(Rn*(1-this.es)+Height)*Sin_Lat;p.x=X;p.y=Y;p.z=Z;return Error_Code},geocentric_to_geodetic:function(p){var genau=1e-12;var genau2=genau*genau;var maxiter=30;var P;var RR;var CT;var ST;var RX;var RK;var RN;var CPHI0;var SPHI0;var CPHI;var SPHI;var SDPHI;var At_Pole;var iter;var X=p.x;var Y=p.y;var Z=p.z?p.z:0;var Longitude;var Latitude;var Height;At_Pole=false;P=Math.sqrt(X*X+Y*Y);RR=Math.sqrt(X*X+Y*Y+Z*Z);if(P/this.a<genau){At_Pole=true;Longitude=0;if(RR/this.a<genau){Latitude=common.HALF_PI;Height=-this.b;return}}else{Longitude=Math.atan2(Y,X)}CT=Z/RR;ST=P/RR;RX=1/Math.sqrt(1-this.es*(2-this.es)*ST*ST);CPHI0=ST*(1-this.es)*RX;SPHI0=CT*RX;iter=0;do{iter++;RN=this.a/Math.sqrt(1-this.es*SPHI0*SPHI0);Height=P*CPHI0+Z*SPHI0-RN*(1-this.es*SPHI0*SPHI0);RK=this.es*RN/(RN+Height);RX=1/Math.sqrt(1-RK*(2-RK)*ST*ST);CPHI=ST*(1-RK)*RX;SPHI=CT*RX;SDPHI=SPHI*CPHI0-CPHI*SPHI0;CPHI0=CPHI;SPHI0=SPHI}while(SDPHI*SDPHI>genau2&&iter<maxiter);Latitude=Math.atan(SPHI/Math.abs(CPHI));p.x=Longitude;p.y=Latitude;p.z=Height;return p},geocentric_to_geodetic_noniter:function(p){var X=p.x;var Y=p.y;var Z=p.z?p.z:0;var Longitude;var Latitude;var Height;var W;var W2;var T0;var T1;var S0;var S1;var Sin_B0;var Sin3_B0;var Cos_B0;var Sin_p1;var Cos_p1;var Rn;var Sum;var At_Pole;X=parseFloat(X);Y=parseFloat(Y);Z=parseFloat(Z);At_Pole=false;if(X!==0){Longitude=Math.atan2(Y,X)}else{if(Y>0){Longitude=common.HALF_PI}else if(Y<0){Longitude=-common.HALF_PI}else{At_Pole=true;Longitude=0;if(Z>0){Latitude=common.HALF_PI}else if(Z<0){Latitude=-common.HALF_PI}else{Latitude=common.HALF_PI;Height=-this.b;return}}}W2=X*X+Y*Y;W=Math.sqrt(W2);T0=Z*common.AD_C;S0=Math.sqrt(T0*T0+W2);Sin_B0=T0/S0;Cos_B0=W/S0;Sin3_B0=Sin_B0*Sin_B0*Sin_B0;T1=Z+this.b*this.ep2*Sin3_B0;Sum=W-this.a*this.es*Cos_B0*Cos_B0*Cos_B0;S1=Math.sqrt(T1*T1+Sum*Sum);Sin_p1=T1/S1;Cos_p1=Sum/S1;Rn=this.a/Math.sqrt(1-this.es*Sin_p1*Sin_p1);if(Cos_p1>=common.COS_67P5){Height=W/Cos_p1-Rn}else if(Cos_p1<=-common.COS_67P5){Height=W/-Cos_p1-Rn}else{Height=Z/Sin_p1+Rn*(this.es-1)}if(At_Pole===false){Latitude=Math.atan(Sin_p1/Cos_p1)}p.x=Longitude;p.y=Latitude;p.z=Height;return p},geocentric_to_wgs84:function(p){if(this.datum_type===common.PJD_3PARAM){p.x+=this.datum_params[0];p.y+=this.datum_params[1];p.z+=this.datum_params[2]}else if(this.datum_type===common.PJD_7PARAM){var Dx_BF=this.datum_params[0];var Dy_BF=this.datum_params[1];var Dz_BF=this.datum_params[2];var Rx_BF=this.datum_params[3];var Ry_BF=this.datum_params[4];var Rz_BF=this.datum_params[5];var M_BF=this.datum_params[6];var x_out=M_BF*(p.x-Rz_BF*p.y+Ry_BF*p.z)+Dx_BF;var y_out=M_BF*(Rz_BF*p.x+p.y-Rx_BF*p.z)+Dy_BF;var z_out=M_BF*(-Ry_BF*p.x+Rx_BF*p.y+p.z)+Dz_BF;p.x=x_out;p.y=y_out;p.z=z_out}},geocentric_from_wgs84:function(p){if(this.datum_type===common.PJD_3PARAM){p.x-=this.datum_params[0];p.y-=this.datum_params[1];p.z-=this.datum_params[2]}else if(this.datum_type===common.PJD_7PARAM){var Dx_BF=this.datum_params[0];var Dy_BF=this.datum_params[1];var Dz_BF=this.datum_params[2];var Rx_BF=this.datum_params[3];var Ry_BF=this.datum_params[4];var Rz_BF=this.datum_params[5];var M_BF=this.datum_params[6];var x_tmp=(p.x-Dx_BF)/M_BF;var y_tmp=(p.y-Dy_BF)/M_BF;var z_tmp=(p.z-Dz_BF)/M_BF;p.x=x_tmp+Rz_BF*y_tmp-Ry_BF*z_tmp;p.y=-Rz_BF*x_tmp+y_tmp+Rx_BF*z_tmp;p.z=Ry_BF*x_tmp-Rx_BF*y_tmp+z_tmp}}};module.exports=datum},{"./common":9}],17:[function(require,module,exports){var common=require("./common");module.exports=function(source,dest,point){var wp,i,l;function checkParams(fallback){return fallback===common.PJD_3PARAM||fallback===common.PJD_7PARAM}if(source.compare_datums(dest)){return point}if(source.datum_type===common.PJD_NODATUM||dest.datum_type===common.PJD_NODATUM){return point}var src_a=source.a;var src_es=source.es;var dst_a=dest.a;var dst_es=dest.es;var fallback=source.datum_type;if(fallback===common.PJD_GRIDSHIFT){if(this.apply_gridshift(source,0,point)===0){source.a=common.SRS_WGS84_SEMIMAJOR;source.es=common.SRS_WGS84_ESQUARED}else{if(!source.datum_params){source.a=src_a;source.es=source.es;return point}wp=1;for(i=0,l=source.datum_params.length;i<l;i++){wp*=source.datum_params[i]}if(wp===0){source.a=src_a;source.es=source.es;return point}if(source.datum_params.length>3){fallback=common.PJD_7PARAM}else{fallback=common.PJD_3PARAM}}}if(dest.datum_type===common.PJD_GRIDSHIFT){dest.a=common.SRS_WGS84_SEMIMAJOR;dest.es=common.SRS_WGS84_ESQUARED}if(source.es!==dest.es||source.a!==dest.a||checkParams(fallback)||checkParams(dest.datum_type)){source.geodetic_to_geocentric(point);if(checkParams(source.datum_type)){source.geocentric_to_wgs84(point)}if(checkParams(dest.datum_type)){dest.geocentric_from_wgs84(point)}dest.geocentric_to_geodetic(point)}if(dest.datum_type===common.PJD_GRIDSHIFT){this.apply_gridshift(dest,1,point)}source.a=src_a;source.es=src_es;dest.a=dst_a;dest.es=dst_es;return point}},{"./common":9}],18:[function(require,module,exports){var globals=require("./global");var parseProj=require("./projString");var wkt=require("./wkt");function defs(name){var that=this;if(arguments.length===2){if(arguments[1][0]==="+"){defs[name]=parseProj(arguments[1])}else{defs[name]=wkt(arguments[1])}}else if(arguments.length===1){if(Array.isArray(name)){return name.map(function(v){if(Array.isArray(v)){defs.apply(that,v)}else{defs(v)}})}else if(typeof name==="string"){}else if("EPSG"in name){defs["EPSG:"+name.EPSG]=name}else if("ESRI"in name){defs["ESRI:"+name.ESRI]=name}else if("IAU2000"in name){defs["IAU2000:"+name.IAU2000]=name}else{console.log(name)}return}}globals(defs);module.exports=defs},{"./global":20,"./projString":23,"./wkt":52}],19:[function(require,module,exports){module.exports=function(destination,source){destination=destination||{};var value,property;if(!source){return destination}for(property in source){value=source[property];if(value!==undefined){destination[property]=value}}return destination}},{}],20:[function(require,module,exports){module.exports=function(defs){defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");defs("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");defs("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");defs("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");defs["EPSG:3785"]=defs["EPSG:3857"];defs.GOOGLE=defs["EPSG:3857"];defs["EPSG:900913"]=defs["EPSG:3857"];defs["EPSG:102113"]=defs["EPSG:3857"]}},{}],21:[function(require,module,exports){var proj4=require("./core");proj4.defaultDatum="WGS84";proj4.Proj=require("./Proj");proj4.WGS84=new proj4.Proj("WGS84");proj4.Point=require("./Point");proj4.defs=require("./defs");proj4.transform=require("./transform");proj4.mgrs=require("./mgrs");proj4.version=require("./version");module.exports=proj4},{"./Point":6,"./Proj":7,"./core":15,"./defs":18,"./mgrs":22,"./transform":50,"./version":51}],22:[function(require,module,exports){var NUM_100K_SETS=6;var SET_ORIGIN_COLUMN_LETTERS="AJSAJS";var SET_ORIGIN_ROW_LETTERS="AFAFAF";var A=65;var I=73;var O=79;var V=86;var Z=90;exports.forward=function(ll,accuracy){accuracy=accuracy||5;return encode(LLtoUTM({lat:ll.lat,lon:ll.lon}),accuracy)};exports.inverse=function(mgrs){var bbox=UTMtoLL(decode(mgrs.toUpperCase()));return[bbox.left,bbox.bottom,bbox.right,bbox.top]};function degToRad(deg){return deg*(Math.PI/180)}function radToDeg(rad){return 180*(rad/Math.PI)}function LLtoUTM(ll){var Lat=ll.lat;var Long=ll.lon;var a=6378137;var eccSquared=.00669438;var k0=.9996;var LongOrigin;var eccPrimeSquared;var N,T,C,A,M;var LatRad=degToRad(Lat);var LongRad=degToRad(Long);var LongOriginRad;var ZoneNumber;ZoneNumber=Math.floor((Long+180)/6)+1;if(Long===180){ZoneNumber=60}if(Lat>=56&&Lat<64&&Long>=3&&Long<12){ZoneNumber=32}if(Lat>=72&&Lat<84){if(Long>=0&&Long<9){ZoneNumber=31}else if(Long>=9&&Long<21){ZoneNumber=33}else if(Long>=21&&Long<33){ZoneNumber=35}else if(Long>=33&&Long<42){ZoneNumber=37}}LongOrigin=(ZoneNumber-1)*6-180+3;LongOriginRad=degToRad(LongOrigin);eccPrimeSquared=eccSquared/(1-eccSquared);N=a/Math.sqrt(1-eccSquared*Math.sin(LatRad)*Math.sin(LatRad));T=Math.tan(LatRad)*Math.tan(LatRad);C=eccPrimeSquared*Math.cos(LatRad)*Math.cos(LatRad);A=Math.cos(LatRad)*(LongRad-LongOriginRad);M=a*((1-eccSquared/4-3*eccSquared*eccSquared/64-5*eccSquared*eccSquared*eccSquared/256)*LatRad-(3*eccSquared/8+3*eccSquared*eccSquared/32+45*eccSquared*eccSquared*eccSquared/1024)*Math.sin(2*LatRad)+(15*eccSquared*eccSquared/256+45*eccSquared*eccSquared*eccSquared/1024)*Math.sin(4*LatRad)-35*eccSquared*eccSquared*eccSquared/3072*Math.sin(6*LatRad));var UTMEasting=k0*N*(A+(1-T+C)*A*A*A/6+(5-18*T+T*T+72*C-58*eccPrimeSquared)*A*A*A*A*A/120)+5e5;var UTMNorthing=k0*(M+N*Math.tan(LatRad)*(A*A/2+(5-T+9*C+4*C*C)*A*A*A*A/24+(61-58*T+T*T+600*C-330*eccPrimeSquared)*A*A*A*A*A*A/720));if(Lat<0){UTMNorthing+=1e7}return{northing:Math.round(UTMNorthing),easting:Math.round(UTMEasting),zoneNumber:ZoneNumber,zoneLetter:getLetterDesignator(Lat)}}function UTMtoLL(utm){var UTMNorthing=utm.northing;var UTMEasting=utm.easting;var zoneLetter=utm.zoneLetter;var zoneNumber=utm.zoneNumber;if(zoneNumber<0||zoneNumber>60){return null}var k0=.9996;var a=6378137;var eccSquared=.00669438;var eccPrimeSquared;var e1=(1-Math.sqrt(1-eccSquared))/(1+Math.sqrt(1-eccSquared));var N1,T1,C1,R1,D,M;var LongOrigin;var mu,phi1Rad;var x=UTMEasting-5e5;var y=UTMNorthing;if(zoneLetter<"N"){y-=1e7}LongOrigin=(zoneNumber-1)*6-180+3;eccPrimeSquared=eccSquared/(1-eccSquared);M=y/k0;mu=M/(a*(1-eccSquared/4-3*eccSquared*eccSquared/64-5*eccSquared*eccSquared*eccSquared/256));phi1Rad=mu+(3*e1/2-27*e1*e1*e1/32)*Math.sin(2*mu)+(21*e1*e1/16-55*e1*e1*e1*e1/32)*Math.sin(4*mu)+151*e1*e1*e1/96*Math.sin(6*mu);N1=a/Math.sqrt(1-eccSquared*Math.sin(phi1Rad)*Math.sin(phi1Rad));T1=Math.tan(phi1Rad)*Math.tan(phi1Rad);C1=eccPrimeSquared*Math.cos(phi1Rad)*Math.cos(phi1Rad);R1=a*(1-eccSquared)/Math.pow(1-eccSquared*Math.sin(phi1Rad)*Math.sin(phi1Rad),1.5);D=x/(N1*k0);var lat=phi1Rad-N1*Math.tan(phi1Rad)/R1*(D*D/2-(5+3*T1+10*C1-4*C1*C1-9*eccPrimeSquared)*D*D*D*D/24+(61+90*T1+298*C1+45*T1*T1-252*eccPrimeSquared-3*C1*C1)*D*D*D*D*D*D/720);lat=radToDeg(lat);var lon=(D-(1+2*T1+C1)*D*D*D/6+(5-2*C1+28*T1-3*C1*C1+8*eccPrimeSquared+24*T1*T1)*D*D*D*D*D/120)/Math.cos(phi1Rad);lon=LongOrigin+radToDeg(lon);var result;if(utm.accuracy){var topRight=UTMtoLL({northing:utm.northing+utm.accuracy,easting:utm.easting+utm.accuracy,zoneLetter:utm.zoneLetter,zoneNumber:utm.zoneNumber});result={top:topRight.lat,right:topRight.lon,bottom:lat,left:lon}}else{result={lat:lat,lon:lon}}return result}function getLetterDesignator(lat){var LetterDesignator="Z";if(84>=lat&&lat>=72){LetterDesignator="X"}else if(72>lat&&lat>=64){LetterDesignator="W"}else if(64>lat&&lat>=56){LetterDesignator="V"}else if(56>lat&&lat>=48){LetterDesignator="U"}else if(48>lat&&lat>=40){LetterDesignator="T"}else if(40>lat&&lat>=32){LetterDesignator="S"}else if(32>lat&&lat>=24){LetterDesignator="R"}else if(24>lat&&lat>=16){LetterDesignator="Q"}else if(16>lat&&lat>=8){LetterDesignator="P"}else if(8>lat&&lat>=0){LetterDesignator="N"}else if(0>lat&&lat>=-8){LetterDesignator="M"}else if(-8>lat&&lat>=-16){LetterDesignator="L"}else if(-16>lat&&lat>=-24){LetterDesignator="K"}else if(-24>lat&&lat>=-32){LetterDesignator="J"}else if(-32>lat&&lat>=-40){LetterDesignator="H"}else if(-40>lat&&lat>=-48){LetterDesignator="G"}else if(-48>lat&&lat>=-56){LetterDesignator="F"}else if(-56>lat&&lat>=-64){LetterDesignator="E"}else if(-64>lat&&lat>=-72){LetterDesignator="D"}else if(-72>lat&&lat>=-80){LetterDesignator="C"}return LetterDesignator}function encode(utm,accuracy){var seasting=""+utm.easting,snorthing=""+utm.northing;return utm.zoneNumber+utm.zoneLetter+get100kID(utm.easting,utm.northing,utm.zoneNumber)+seasting.substr(seasting.length-5,accuracy)+snorthing.substr(snorthing.length-5,accuracy)}function get100kID(easting,northing,zoneNumber){var setParm=get100kSetForZone(zoneNumber);var setColumn=Math.floor(easting/1e5);var setRow=Math.floor(northing/1e5)%20;return getLetter100kID(setColumn,setRow,setParm)}function get100kSetForZone(i){var setParm=i%NUM_100K_SETS;if(setParm===0){setParm=NUM_100K_SETS}return setParm}function getLetter100kID(column,row,parm){var index=parm-1;var colOrigin=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);var rowOrigin=SET_ORIGIN_ROW_LETTERS.charCodeAt(index);var colInt=colOrigin+column-1;var rowInt=rowOrigin+row;var rollover=false;if(colInt>Z){colInt=colInt-Z+A-1;rollover=true}if(colInt===I||colOrigin<I&&colInt>I||(colInt>I||colOrigin<I)&&rollover){colInt++}if(colInt===O||colOrigin<O&&colInt>O||(colInt>O||colOrigin<O)&&rollover){colInt++;if(colInt===I){colInt++}}if(colInt>Z){colInt=colInt-Z+A-1}if(rowInt>V){rowInt=rowInt-V+A-1;rollover=true}else{rollover=false}if(rowInt===I||rowOrigin<I&&rowInt>I||(rowInt>I||rowOrigin<I)&&rollover){rowInt++}if(rowInt===O||rowOrigin<O&&rowInt>O||(rowInt>O||rowOrigin<O)&&rollover){rowInt++;if(rowInt===I){rowInt++}}if(rowInt>V){rowInt=rowInt-V+A-1}var twoLetter=String.fromCharCode(colInt)+String.fromCharCode(rowInt);return twoLetter}function decode(mgrsString){if(mgrsString&&mgrsString.length===0){throw"MGRSPoint coverting from nothing"}var length=mgrsString.length;var hunK=null;var sb="";var testChar;var i=0;while(!/[A-Z]/.test(testChar=mgrsString.charAt(i))){if(i>=2){throw"MGRSPoint bad conversion from: "+mgrsString}sb+=testChar;i++}var zoneNumber=parseInt(sb,10);if(i===0||i+3>length){throw"MGRSPoint bad conversion from: "+mgrsString}var zoneLetter=mgrsString.charAt(i++);if(zoneLetter<="A"||zoneLetter==="B"||zoneLetter==="Y"||zoneLetter>="Z"||zoneLetter==="I"||zoneLetter==="O"){throw"MGRSPoint zone letter "+zoneLetter+" not handled: "+mgrsString}hunK=mgrsString.substring(i,i+=2);var set=get100kSetForZone(zoneNumber);var east100k=getEastingFromChar(hunK.charAt(0),set);var north100k=getNorthingFromChar(hunK.charAt(1),set);while(north100k<getMinNorthing(zoneLetter)){north100k+=2e6}var remainder=length-i;if(remainder%2!==0){throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+mgrsString}var sep=remainder/2;var sepEasting=0;var sepNorthing=0;var accuracyBonus,sepEastingString,sepNorthingString,easting,northing;if(sep>0){accuracyBonus=1e5/Math.pow(10,sep);sepEastingString=mgrsString.substring(i,i+sep);sepEasting=parseFloat(sepEastingString)*accuracyBonus;sepNorthingString=mgrsString.substring(i+sep);sepNorthing=parseFloat(sepNorthingString)*accuracyBonus}easting=sepEasting+east100k;northing=sepNorthing+north100k;return{easting:easting,northing:northing,zoneLetter:zoneLetter,zoneNumber:zoneNumber,accuracy:accuracyBonus}}function getEastingFromChar(e,set){var curCol=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set-1);var eastingValue=1e5;var rewindMarker=false;while(curCol!==e.charCodeAt(0)){curCol++;if(curCol===I){curCol++}if(curCol===O){curCol++}if(curCol>Z){if(rewindMarker){throw"Bad character: "+e}curCol=A;rewindMarker=true}eastingValue+=1e5}return eastingValue}function getNorthingFromChar(n,set){if(n>"V"){throw"MGRSPoint given invalid Northing "+n}var curRow=SET_ORIGIN_ROW_LETTERS.charCodeAt(set-1);var northingValue=0;var rewindMarker=false;while(curRow!==n.charCodeAt(0)){curRow++;if(curRow===I){curRow++}if(curRow===O){curRow++}if(curRow>V){if(rewindMarker){throw"Bad character: "+n}curRow=A;rewindMarker=true}northingValue+=1e5}return northingValue}function getMinNorthing(zoneLetter){var northing;switch(zoneLetter){case"C":northing=11e5;break;case"D":northing=2e6;break;case"E":northing=28e5;break;case"F":northing=37e5;break;case"G":northing=46e5;break;case"H":northing=55e5;break;case"J":northing=64e5;break;case"K":northing=73e5;break;case"L":northing=82e5;break;case"M":northing=91e5;break;case"N":northing=0;break;case"P":northing=8e5;break;case"Q":northing=17e5;break;case"R":northing=26e5;break;case"S":northing=35e5;break;case"T":northing=44e5;break;case"U":northing=53e5;break;case"V":northing=62e5;break;case"W":northing=7e6;break;case"X":northing=79e5;break;default:northing=-1}if(northing>=0){return northing}else{throw"Invalid zone letter: "+zoneLetter}}},{}],23:[function(require,module,exports){var common=require("./common");var constants=require("./constants/index");module.exports=function(defData){var self={};var paramObj={};defData.split("+").map(function(v){return v.trim()}).filter(function(a){return a}).forEach(function(a){var split=a.split("=");split.push(true);paramObj[split[0].toLowerCase()]=split[1]});var paramName,paramVal,paramOutname;var params={proj:"projName",datum:"datumCode",rf:function(v){self.rf=parseFloat(v,10)},lat_0:function(v){self.lat0=v*common.D2R},lat_1:function(v){self.lat1=v*common.D2R},lat_2:function(v){self.lat2=v*common.D2R},lat_ts:function(v){self.lat_ts=v*common.D2R},lon_0:function(v){self.long0=v*common.D2R},lon_1:function(v){self.long1=v*common.D2R},lon_2:function(v){self.long2=v*common.D2R},alpha:function(v){self.alpha=parseFloat(v)*common.D2R},lonc:function(v){self.longc=v*common.D2R},x_0:function(v){self.x0=parseFloat(v,10)},y_0:function(v){self.y0=parseFloat(v,10)},k_0:function(v){self.k0=parseFloat(v,10)},k:function(v){self.k0=parseFloat(v,10)},r_a:function(){self.R_A=true},zone:function(v){self.zone=parseInt(v,10)},south:function(){self.utmSouth=true},towgs84:function(v){self.datum_params=v.split(",").map(function(a){return parseFloat(a,10)})},to_meter:function(v){self.to_meter=parseFloat(v,10)},from_greenwich:function(v){self.from_greenwich=v*common.D2R},pm:function(v){self.from_greenwich=(constants.PrimeMeridian[v]?constants.PrimeMeridian[v]:parseFloat(v,10))*common.D2R},nadgrids:function(v){if(v==="@null"){self.datumCode="none"}else{self.nadgrids=v}},axis:function(v){var legalAxis="ewnsud";if(v.length===3&&legalAxis.indexOf(v.substr(0,1))!==-1&&legalAxis.indexOf(v.substr(1,1))!==-1&&legalAxis.indexOf(v.substr(2,1))!==-1){self.axis=v}}};for(paramName in paramObj){paramVal=paramObj[paramName];if(paramName in params){paramOutname=params[paramName];if(typeof paramOutname==="function"){paramOutname(paramVal)}else{self[paramOutname]=paramVal}}else{self[paramName]=paramVal}}return self}},{"./common":9,"./constants/index":14}],24:[function(require,module,exports){var common=require("../common");exports.init=function(){if(Math.abs(this.lat1+this.lat2)<common.EPSLN){return}this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e3=Math.sqrt(this.es);this.sin_po=Math.sin(this.lat1);this.cos_po=Math.cos(this.lat1);this.t1=this.sin_po;this.con=this.sin_po;this.ms1=common.msfnz(this.e3,this.sin_po,this.cos_po);this.qs1=common.qsfnz(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat2);this.cos_po=Math.cos(this.lat2);this.t2=this.sin_po;this.ms2=common.msfnz(this.e3,this.sin_po,this.cos_po);this.qs2=common.qsfnz(this.e3,this.sin_po,this.cos_po);this.sin_po=Math.sin(this.lat0);this.cos_po=Math.cos(this.lat0);this.t3=this.sin_po;this.qs0=common.qsfnz(this.e3,this.sin_po,this.cos_po);if(Math.abs(this.lat1-this.lat2)>common.EPSLN){this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1)}else{this.ns0=this.con}this.c=this.ms1*this.ms1+this.ns0*this.qs1;this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0};exports.forward=function(p){var lon=p.x;var lat=p.y;this.sin_phi=Math.sin(lat);this.cos_phi=Math.cos(lat);var qs=common.qsfnz(this.e3,this.sin_phi,this.cos_phi);var rh1=this.a*Math.sqrt(this.c-this.ns0*qs)/this.ns0;var theta=this.ns0*common.adjust_lon(lon-this.long0);var x=rh1*Math.sin(theta)+this.x0;var y=this.rh-rh1*Math.cos(theta)+this.y0;p.x=x;p.y=y;return p};exports.inverse=function(p){var rh1,qs,con,theta,lon,lat;p.x-=this.x0;p.y=this.rh-p.y+this.y0;if(this.ns0>=0){rh1=Math.sqrt(p.x*p.x+p.y*p.y);con=1}else{rh1=-Math.sqrt(p.x*p.x+p.y*p.y);con=-1}theta=0;if(rh1!==0){theta=Math.atan2(con*p.x,con*p.y)}con=rh1*this.ns0/this.a;if(this.sphere){lat=Math.asin((this.c-con*con)/(2*this.ns0))}else{qs=(this.c-con*con)/this.ns0;lat=this.phi1z(this.e3,qs)}lon=common.adjust_lon(theta/this.ns0+this.long0);p.x=lon;p.y=lat;return p};exports.phi1z=function(eccent,qs){var sinphi,cosphi,con,com,dphi;var phi=common.asinz(.5*qs);if(eccent<common.EPSLN){return phi}var eccnts=eccent*eccent;for(var i=1;i<=25;i++){sinphi=Math.sin(phi);cosphi=Math.cos(phi);con=eccent*sinphi;com=1-con*con;dphi=.5*com*com/cosphi*(qs/(1-eccnts)-sinphi/com+.5/eccent*Math.log((1-con)/(1+con)));phi=phi+dphi;if(Math.abs(dphi)<=1e-7){return phi}}return null};exports.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common":9}],25:[function(require,module,exports){var common=require("../common");exports.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};exports.forward=function(p){var lon=p.x;var lat=p.y;var sinphi=Math.sin(p.y);var cosphi=Math.cos(p.y);var dlon=common.adjust_lon(lon-this.long0);var e0,e1,e2,e3,Mlp,Ml,tanphi,Nl1,Nl,psi,Az,G,H,GH,Hs,c,kp,cos_c,s,s2,s3,s4,s5;if(this.sphere){if(Math.abs(this.sin_p12-1)<=common.EPSLN){p.x=this.x0+this.a*(common.HALF_PI-lat)*Math.sin(dlon);p.y=this.y0-this.a*(common.HALF_PI-lat)*Math.cos(dlon);return p}else if(Math.abs(this.sin_p12+1)<=common.EPSLN){p.x=this.x0+this.a*(common.HALF_PI+lat)*Math.sin(dlon);p.y=this.y0+this.a*(common.HALF_PI+lat)*Math.cos(dlon);return p}else{cos_c=this.sin_p12*sinphi+this.cos_p12*cosphi*Math.cos(dlon);c=Math.acos(cos_c);kp=c/Math.sin(c);p.x=this.x0+this.a*kp*cosphi*Math.sin(dlon);p.y=this.y0+this.a*kp*(this.cos_p12*sinphi-this.sin_p12*cosphi*Math.cos(dlon));return p}}else{e0=common.e0fn(this.es);e1=common.e1fn(this.es);e2=common.e2fn(this.es);e3=common.e3fn(this.es);if(Math.abs(this.sin_p12-1)<=common.EPSLN){Mlp=this.a*common.mlfn(e0,e1,e2,e3,common.HALF_PI);Ml=this.a*common.mlfn(e0,e1,e2,e3,lat);p.x=this.x0+(Mlp-Ml)*Math.sin(dlon);p.y=this.y0-(Mlp-Ml)*Math.cos(dlon);return p}else if(Math.abs(this.sin_p12+1)<=common.EPSLN){Mlp=this.a*common.mlfn(e0,e1,e2,e3,common.HALF_PI);Ml=this.a*common.mlfn(e0,e1,e2,e3,lat);p.x=this.x0+(Mlp+Ml)*Math.sin(dlon);p.y=this.y0+(Mlp+Ml)*Math.cos(dlon);return p}else{tanphi=sinphi/cosphi;Nl1=common.gN(this.a,this.e,this.sin_p12);Nl=common.gN(this.a,this.e,sinphi);psi=Math.atan((1-this.es)*tanphi+this.es*Nl1*this.sin_p12/(Nl*cosphi));Az=Math.atan2(Math.sin(dlon),this.cos_p12*Math.tan(psi)-this.sin_p12*Math.cos(dlon));if(Az===0){s=Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi))}else if(Math.abs(Math.abs(Az)-common.PI)<=common.EPSLN){s=-Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi))}else{s=Math.asin(Math.sin(dlon)*Math.cos(psi)/Math.sin(Az))}G=this.e*this.sin_p12/Math.sqrt(1-this.es);H=this.e*this.cos_p12*Math.cos(Az)/Math.sqrt(1-this.es);GH=G*H;Hs=H*H;s2=s*s;s3=s2*s;s4=s3*s;s5=s4*s;c=Nl1*s*(1-s2*Hs*(1-Hs)/6+s3/8*GH*(1-2*Hs)+s4/120*(Hs*(4-7*Hs)-3*G*G*(1-7*Hs))-s5/48*GH);p.x=this.x0+c*Math.sin(Az);p.y=this.y0+c*Math.cos(Az);return p}}};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var rh,z,sinz,cosz,lon,lat,con,e0,e1,e2,e3,Mlp,M,N1,psi,Az,cosAz,tmp,A,B,D,Ee,F;if(this.sphere){rh=Math.sqrt(p.x*p.x+p.y*p.y);if(rh>2*common.HALF_PI*this.a){return}z=rh/this.a;sinz=Math.sin(z);cosz=Math.cos(z);lon=this.long0;if(Math.abs(rh)<=common.EPSLN){lat=this.lat0}else{lat=common.asinz(cosz*this.sin_p12+p.y*sinz*this.cos_p12/rh);con=Math.abs(this.lat0)-common.HALF_PI;if(Math.abs(con)<=common.EPSLN){if(this.lat0>=0){lon=common.adjust_lon(this.long0+Math.atan2(p.x,-p.y))}else{lon=common.adjust_lon(this.long0-Math.atan2(-p.x,p.y))}}else{lon=common.adjust_lon(this.long0+Math.atan2(p.x*sinz,rh*this.cos_p12*cosz-p.y*this.sin_p12*sinz))}}p.x=lon;p.y=lat;return p}else{e0=common.e0fn(this.es);e1=common.e1fn(this.es);e2=common.e2fn(this.es);e3=common.e3fn(this.es);if(Math.abs(this.sin_p12-1)<=common.EPSLN){Mlp=this.a*common.mlfn(e0,e1,e2,e3,common.HALF_PI);rh=Math.sqrt(p.x*p.x+p.y*p.y);M=Mlp-rh;lat=common.imlfn(M/this.a,e0,e1,e2,e3);lon=common.adjust_lon(this.long0+Math.atan2(p.x,-1*p.y));p.x=lon;p.y=lat;return p}else if(Math.abs(this.sin_p12+1)<=common.EPSLN){Mlp=this.a*common.mlfn(e0,e1,e2,e3,common.HALF_PI);rh=Math.sqrt(p.x*p.x+p.y*p.y);M=rh-Mlp;lat=common.imlfn(M/this.a,e0,e1,e2,e3);lon=common.adjust_lon(this.long0+Math.atan2(p.x,p.y));p.x=lon;p.y=lat;return p}else{rh=Math.sqrt(p.x*p.x+p.y*p.y);Az=Math.atan2(p.x,p.y);N1=common.gN(this.a,this.e,this.sin_p12);cosAz=Math.cos(Az);tmp=this.e*this.cos_p12*cosAz;A=-tmp*tmp/(1-this.es);B=3*this.es*(1-A)*this.sin_p12*this.cos_p12*cosAz/(1-this.es);D=rh/N1;Ee=D-A*(1+A)*Math.pow(D,3)/6-B*(1+3*A)*Math.pow(D,4)/24;F=1-A*Ee*Ee/2-D*Ee*Ee*Ee/6;psi=Math.asin(this.sin_p12*Math.cos(Ee)+this.cos_p12*Math.sin(Ee)*cosAz);lon=common.adjust_lon(this.long0+Math.asin(Math.sin(Az)*Math.sin(Ee)/Math.cos(psi)));lat=Math.atan((1-this.es*F*this.sin_p12/Math.sin(psi))*Math.tan(psi)/(1-this.es));
p.x=lon;p.y=lat;return p}}};exports.names=["Azimuthal_Equidistant","aeqd"]},{"../common":9}],26:[function(require,module,exports){var common=require("../common");exports.init=function(){if(!this.sphere){this.e0=common.e0fn(this.es);this.e1=common.e1fn(this.es);this.e2=common.e2fn(this.es);this.e3=common.e3fn(this.es);this.ml0=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)}};exports.forward=function(p){var x,y;var lam=p.x;var phi=p.y;lam=common.adjust_lon(lam-this.long0);if(this.sphere){x=this.a*Math.asin(Math.cos(phi)*Math.sin(lam));y=this.a*(Math.atan2(Math.tan(phi),Math.cos(lam))-this.lat0)}else{var sinphi=Math.sin(phi);var cosphi=Math.cos(phi);var nl=common.gN(this.a,this.e,sinphi);var tl=Math.tan(phi)*Math.tan(phi);var al=lam*Math.cos(phi);var asq=al*al;var cl=this.es*cosphi*cosphi/(1-this.es);var ml=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,phi);x=nl*al*(1-asq*tl*(1/6-(8-tl+8*cl)*asq/120));y=ml-this.ml0+nl*sinphi/cosphi*asq*(.5+(5-tl+6*cl)*asq/24)}p.x=x+this.x0;p.y=y+this.y0;return p};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var x=p.x/this.a;var y=p.y/this.a;var phi,lam;if(this.sphere){var dd=y+this.lat0;phi=Math.asin(Math.sin(dd)*Math.cos(x));lam=Math.atan2(Math.tan(x),Math.cos(dd))}else{var ml1=this.ml0/this.a+y;var phi1=common.imlfn(ml1,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(phi1)-common.HALF_PI)<=common.EPSLN){p.x=this.long0;p.y=common.HALF_PI;if(y<0){p.y*=-1}return p}var nl1=common.gN(this.a,this.e,Math.sin(phi1));var rl1=nl1*nl1*nl1/this.a/this.a*(1-this.es);var tl1=Math.pow(Math.tan(phi1),2);var dl=x*this.a/nl1;var dsq=dl*dl;phi=phi1-nl1*Math.tan(phi1)/rl1*dl*dl*(.5-(1+3*tl1)*dl*dl/24);lam=dl*(1-dsq*(tl1/3+(1+3*tl1)*tl1*dsq/15))/Math.cos(phi1)}p.x=common.adjust_lon(lam+this.long0);p.y=common.adjust_lat(phi);return p};exports.names=["Cassini","Cassini_Soldner","cass"]},{"../common":9}],27:[function(require,module,exports){var common=require("../common");exports.init=function(){if(!this.sphere){this.k0=common.msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}};exports.forward=function(p){var lon=p.x;var lat=p.y;var x,y;var dlon=common.adjust_lon(lon-this.long0);if(this.sphere){x=this.x0+this.a*dlon*Math.cos(this.lat_ts);y=this.y0+this.a*Math.sin(lat)/Math.cos(this.lat_ts)}else{var qs=common.qsfnz(this.e,Math.sin(lat));x=this.x0+this.a*this.k0*dlon;y=this.y0+this.a*qs*.5/this.k0}p.x=x;p.y=y;return p};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var lon,lat;if(this.sphere){lon=common.adjust_lon(this.long0+p.x/this.a/Math.cos(this.lat_ts));lat=Math.asin(p.y/this.a*Math.cos(this.lat_ts))}else{lat=common.iqsfnz(this.e,2*p.y*this.k0/this.a);lon=common.adjust_lon(this.long0+p.x/(this.a*this.k0))}p.x=lon;p.y=lat;return p};exports.names=["cea"]},{"../common":9}],28:[function(require,module,exports){var common=require("../common");exports.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_t||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};exports.forward=function(p){var lon=p.x;var lat=p.y;var dlon=common.adjust_lon(lon-this.long0);var dlat=common.adjust_lat(lat-this.lat0);p.x=this.x0+this.a*dlon*this.rc;p.y=this.y0+this.a*dlat;return p};exports.inverse=function(p){var x=p.x;var y=p.y;p.x=common.adjust_lon(this.long0+(x-this.x0)/(this.a*this.rc));p.y=common.adjust_lat(this.lat0+(y-this.y0)/this.a);return p};exports.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common":9}],29:[function(require,module,exports){var common=require("../common");exports.init=function(){if(Math.abs(this.lat1+this.lat2)<common.EPSLN){common.reportError("eqdc:init: Equal Latitudes");return}this.lat2=this.lat2||this.lat1;this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=common.e0fn(this.es);this.e1=common.e1fn(this.es);this.e2=common.e2fn(this.es);this.e3=common.e3fn(this.es);this.sinphi=Math.sin(this.lat1);this.cosphi=Math.cos(this.lat1);this.ms1=common.msfnz(this.e,this.sinphi,this.cosphi);this.ml1=common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1);if(Math.abs(this.lat1-this.lat2)<common.EPSLN){this.ns=this.sinphi}else{this.sinphi=Math.sin(this.lat2);this.cosphi=Math.cos(this.lat2);this.ms2=common.msfnz(this.e,this.sinphi,this.cosphi);this.ml2=common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2);this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)}this.g=this.ml1+this.ms1/this.ns;this.ml0=common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0);this.rh=this.a*(this.g-this.ml0)};exports.forward=function(p){var lon=p.x;var lat=p.y;var rh1;if(this.sphere){rh1=this.a*(this.g-lat)}else{var ml=common.mlfn(this.e0,this.e1,this.e2,this.e3,lat);rh1=this.a*(this.g-ml)}var theta=this.ns*common.adjust_lon(lon-this.long0);var x=this.x0+rh1*Math.sin(theta);var y=this.y0+this.rh-rh1*Math.cos(theta);p.x=x;p.y=y;return p};exports.inverse=function(p){p.x-=this.x0;p.y=this.rh-p.y+this.y0;var con,rh1,lat,lon;if(this.ns>=0){rh1=Math.sqrt(p.x*p.x+p.y*p.y);con=1}else{rh1=-Math.sqrt(p.x*p.x+p.y*p.y);con=-1}var theta=0;if(rh1!==0){theta=Math.atan2(con*p.x,con*p.y)}if(this.sphere){lon=common.adjust_lon(this.long0+theta/this.ns);lat=common.adjust_lat(this.g-rh1/this.a);p.x=lon;p.y=lat;return p}else{var ml=this.g-rh1/this.a;lat=common.imlfn(ml,this.e0,this.e1,this.e2,this.e3);lon=common.adjust_lon(this.long0+theta/this.ns);p.x=lon;p.y=lat;return p}};exports.names=["Equidistant_Conic","eqdc"]},{"../common":9}],30:[function(require,module,exports){var common=require("../common");exports.init=function(){var sphi=Math.sin(this.lat0);var cphi=Math.cos(this.lat0);cphi*=cphi;this.rc=Math.sqrt(1-this.es)/(1-this.es*sphi*sphi);this.C=Math.sqrt(1+this.es*cphi*cphi/(1-this.es));this.phic0=Math.asin(sphi/this.C);this.ratexp=.5*this.C*this.e;this.K=Math.tan(.5*this.phic0+common.FORTPI)/(Math.pow(Math.tan(.5*this.lat0+common.FORTPI),this.C)*common.srat(this.e*sphi,this.ratexp))};exports.forward=function(p){var lon=p.x;var lat=p.y;p.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*lat+common.FORTPI),this.C)*common.srat(this.e*Math.sin(lat),this.ratexp))-common.HALF_PI;p.x=this.C*lon;return p};exports.inverse=function(p){var DEL_TOL=1e-14;var lon=p.x/this.C;var lat=p.y;var num=Math.pow(Math.tan(.5*lat+common.FORTPI)/this.K,1/this.C);for(var i=common.MAX_ITER;i>0;--i){lat=2*Math.atan(num*common.srat(this.e*Math.sin(p.y),-.5*this.e))-common.HALF_PI;if(Math.abs(lat-p.y)<DEL_TOL){break}p.y=lat}if(!i){return null}p.x=lon;p.y=lat;return p};exports.names=["gauss"]},{"../common":9}],31:[function(require,module,exports){var common=require("../common");exports.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1e3*this.a;this.rc=1};exports.forward=function(p){var sinphi,cosphi;var dlon;var coslon;var ksp;var g;var x,y;var lon=p.x;var lat=p.y;dlon=common.adjust_lon(lon-this.long0);sinphi=Math.sin(lat);cosphi=Math.cos(lat);coslon=Math.cos(dlon);g=this.sin_p14*sinphi+this.cos_p14*cosphi*coslon;ksp=1;if(g>0||Math.abs(g)<=common.EPSLN){x=this.x0+this.a*ksp*cosphi*Math.sin(dlon)/g;y=this.y0+this.a*ksp*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)/g}else{x=this.x0+this.infinity_dist*cosphi*Math.sin(dlon);y=this.y0+this.infinity_dist*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)}p.x=x;p.y=y;return p};exports.inverse=function(p){var rh;var sinc,cosc;var c;var lon,lat;p.x=(p.x-this.x0)/this.a;p.y=(p.y-this.y0)/this.a;p.x/=this.k0;p.y/=this.k0;if(rh=Math.sqrt(p.x*p.x+p.y*p.y)){c=Math.atan2(rh,this.rc);sinc=Math.sin(c);cosc=Math.cos(c);lat=common.asinz(cosc*this.sin_p14+p.y*sinc*this.cos_p14/rh);lon=Math.atan2(p.x*sinc,rh*this.cos_p14*cosc-p.y*this.sin_p14*sinc);lon=common.adjust_lon(this.long0+lon)}else{lat=this.phic0;lon=0}p.x=lon;p.y=lat;return p};exports.names=["gnom"]},{"../common":9}],32:[function(require,module,exports){var projs=[require("./tmerc"),require("./utm"),require("./sterea"),require("./stere"),require("./somerc"),require("./omerc"),require("./lcc"),require("./krovak"),require("./cass"),require("./laea"),require("./merc"),require("./aea"),require("./gnom"),require("./cea"),require("./eqc"),require("./poly"),require("./nzmg"),require("./mill"),require("./sinu"),require("./moll"),require("./eqdc"),require("./vandg"),require("./aeqd"),require("./longlat")];var names={};var projStore=[];function add(proj,i){var len=projStore.length;if(!proj.names){console.log(i);return true}projStore[len]=proj;proj.names.forEach(function(n){names[n.toLowerCase()]=len});return this}exports.add=add;exports.get=function(name){if(!name){return false}var n=name.toLowerCase();if(typeof names[n]!=="undefined"&&projStore[names[n]]){return projStore[names[n]]}};exports.start=function(){projs.forEach(add)}},{"./aea":24,"./aeqd":25,"./cass":26,"./cea":27,"./eqc":28,"./eqdc":29,"./gnom":31,"./krovak":33,"./laea":34,"./lcc":35,"./longlat":36,"./merc":37,"./mill":38,"./moll":39,"./nzmg":40,"./omerc":41,"./poly":42,"./sinu":43,"./somerc":44,"./stere":45,"./sterea":46,"./tmerc":47,"./utm":48,"./vandg":49}],33:[function(require,module,exports){var common=require("../common");exports.init=function(){this.a=6377397.155;this.es=.006674372230614;this.e=Math.sqrt(this.es);if(!this.lat0){this.lat0=.863937979737193}if(!this.long0){this.long0=.7417649320975901-.308341501185665}if(!this.k0){this.k0=.9999}this.s45=.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};exports.forward=function(p){var gfi,u,deltav,s,d,eps,ro;var lon=p.x;var lat=p.y;var delta_lon=common.adjust_lon(lon-this.long0);gfi=Math.pow((1+this.e*Math.sin(lat))/(1-this.e*Math.sin(lat)),this.alfa*this.e/2);u=2*(Math.atan(this.k*Math.pow(Math.tan(lat/2+this.s45),this.alfa)/gfi)-this.s45);deltav=-delta_lon*this.alfa;s=Math.asin(Math.cos(this.ad)*Math.sin(u)+Math.sin(this.ad)*Math.cos(u)*Math.cos(deltav));d=Math.asin(Math.cos(u)*Math.sin(deltav)/Math.cos(s));eps=this.n*d;ro=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n);p.y=ro*Math.cos(eps)/1;p.x=ro*Math.sin(eps)/1;if(!this.czech){p.y*=-1;p.x*=-1}return p};exports.inverse=function(p){var u,deltav,s,d,eps,ro,fi1;var ok;var tmp=p.x;p.x=p.y;p.y=tmp;if(!this.czech){p.y*=-1;p.x*=-1}ro=Math.sqrt(p.x*p.x+p.y*p.y);eps=Math.atan2(p.y,p.x);d=eps/Math.sin(this.s0);s=2*(Math.atan(Math.pow(this.ro0/ro,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);u=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(d));deltav=Math.asin(Math.cos(s)*Math.sin(d)/Math.cos(u));p.x=this.long0-deltav/this.alfa;fi1=u;ok=0;var iter=0;do{p.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(u/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(fi1))/(1-this.e*Math.sin(fi1)),this.e/2))-this.s45);if(Math.abs(fi1-p.y)<1e-10){ok=1}fi1=p.y;iter+=1}while(ok===0&&iter<15);if(iter>=15){return null}return p};exports.names=["Krovak","krovak"]},{"../common":9}],34:[function(require,module,exports){var common=require("../common");exports.S_POLE=1;exports.N_POLE=2;exports.EQUIT=3;exports.OBLIQ=4;exports.init=function(){var t=Math.abs(this.lat0);if(Math.abs(t-common.HALF_PI)<common.EPSLN){this.mode=this.lat0<0?this.S_POLE:this.N_POLE}else if(Math.abs(t)<common.EPSLN){this.mode=this.EQUIT}else{this.mode=this.OBLIQ}if(this.es>0){var sinphi;this.qp=common.qsfnz(this.e,1);this.mmf=.5/(1-this.es);this.apa=this.authset(this.es);switch(this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp);sinphi=Math.sin(this.lat0);this.sinb1=common.qsfnz(this.e,sinphi)/this.qp;this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1);this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*sinphi*sinphi)*this.rq*this.cosb1);this.ymf=(this.xmf=this.rq)/this.dd;this.xmf*=this.dd;break}}else{if(this.mode===this.OBLIQ){this.sinph0=Math.sin(this.lat0);this.cosph0=Math.cos(this.lat0)}}};exports.forward=function(p){var x,y,coslam,sinlam,sinphi,q,sinb,cosb,b,cosphi;var lam=p.x;var phi=p.y;lam=common.adjust_lon(lam-this.long0);if(this.sphere){sinphi=Math.sin(phi);cosphi=Math.cos(phi);coslam=Math.cos(lam);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){y=this.mode===this.EQUIT?1+cosphi*coslam:1+this.sinph0*sinphi+this.cosph0*cosphi*coslam;if(y<=common.EPSLN){return null}y=Math.sqrt(2/y);x=y*cosphi*Math.sin(lam);y*=this.mode===this.EQUIT?sinphi:this.cosph0*sinphi-this.sinph0*cosphi*coslam}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE){coslam=-coslam}if(Math.abs(phi+this.phi0)<common.EPSLN){return null}y=common.FORTPI-phi*.5;y=2*(this.mode===this.S_POLE?Math.cos(y):Math.sin(y));x=y*Math.sin(lam);y*=coslam}}else{sinb=0;cosb=0;b=0;coslam=Math.cos(lam);sinlam=Math.sin(lam);sinphi=Math.sin(phi);q=common.qsfnz(this.e,sinphi);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){sinb=q/this.qp;cosb=Math.sqrt(1-sinb*sinb)}switch(this.mode){case this.OBLIQ:b=1+this.sinb1*sinb+this.cosb1*cosb*coslam;break;case this.EQUIT:b=1+cosb*coslam;break;case this.N_POLE:b=common.HALF_PI+phi;q=this.qp-q;break;case this.S_POLE:b=phi-common.HALF_PI;q=this.qp+q;break}if(Math.abs(b)<common.EPSLN){return null}switch(this.mode){case this.OBLIQ:case this.EQUIT:b=Math.sqrt(2/b);if(this.mode===this.OBLIQ){y=this.ymf*b*(this.cosb1*sinb-this.sinb1*cosb*coslam)}else{y=(b=Math.sqrt(2/(1+cosb*coslam)))*sinb*this.ymf}x=this.xmf*b*cosb*sinlam;break;case this.N_POLE:case this.S_POLE:if(q>=0){x=(b=Math.sqrt(q))*sinlam;y=coslam*(this.mode===this.S_POLE?b:-b)}else{x=y=0}break}}p.x=this.a*x+this.x0;p.y=this.a*y+this.y0;return p};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var x=p.x/this.a;var y=p.y/this.a;var lam,phi,cCe,sCe,q,rho,ab;if(this.sphere){var cosz=0,rh,sinz=0;rh=Math.sqrt(x*x+y*y);phi=rh*.5;if(phi>1){return null}phi=2*Math.asin(phi);if(this.mode===this.OBLIQ||this.mode===this.EQUIT){sinz=Math.sin(phi);cosz=Math.cos(phi)}switch(this.mode){case this.EQUIT:phi=Math.abs(rh)<=common.EPSLN?0:Math.asin(y*sinz/rh);x*=sinz;y=cosz*rh;break;case this.OBLIQ:phi=Math.abs(rh)<=common.EPSLN?this.phi0:Math.asin(cosz*this.sinph0+y*sinz*this.cosph0/rh);x*=sinz*this.cosph0;y=(cosz-Math.sin(phi)*this.sinph0)*rh;break;case this.N_POLE:y=-y;phi=common.HALF_PI-phi;break;case this.S_POLE:phi-=common.HALF_PI;break}lam=y===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(x,y)}else{ab=0;if(this.mode===this.OBLIQ||this.mode===this.EQUIT){x/=this.dd;y*=this.dd;rho=Math.sqrt(x*x+y*y);if(rho<common.EPSLN){p.x=0;p.y=this.phi0;return p}sCe=2*Math.asin(.5*rho/this.rq);cCe=Math.cos(sCe);x*=sCe=Math.sin(sCe);if(this.mode===this.OBLIQ){ab=cCe*this.sinb1+y*sCe*this.cosb1/rho;q=this.qp*ab;y=rho*this.cosb1*cCe-y*this.sinb1*sCe}else{ab=y*sCe/rho;q=this.qp*ab;y=rho*cCe}}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE){y=-y}q=x*x+y*y;if(!q){p.x=0;p.y=this.phi0;return p}ab=1-q/this.qp;if(this.mode===this.S_POLE){ab=-ab}}lam=Math.atan2(x,y);phi=this.authlat(Math.asin(ab),this.apa)}p.x=common.adjust_lon(this.long0+lam);p.y=phi;return p};exports.P00=.3333333333333333;exports.P01=.17222222222222222;exports.P02=.10257936507936508;exports.P10=.06388888888888888;exports.P11=.0664021164021164;exports.P20=.016415012942191543;exports.authset=function(es){var t;var APA=[];APA[0]=es*this.P00;t=es*es;APA[0]+=t*this.P01;APA[1]=t*this.P10;t*=es;APA[0]+=t*this.P02;APA[1]+=t*this.P11;APA[2]=t*this.P20;return APA};exports.authlat=function(beta,APA){var t=beta+beta;return beta+APA[0]*Math.sin(t)+APA[1]*Math.sin(t+t)+APA[2]*Math.sin(t+t+t)};exports.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common":9}],35:[function(require,module,exports){var common=require("../common");exports.init=function(){if(!this.lat2){this.lat2=this.lat1}if(!this.k0){this.k0=1}if(Math.abs(this.lat1+this.lat2)<common.EPSLN){return}var temp=this.b/this.a;this.e=Math.sqrt(1-temp*temp);var sin1=Math.sin(this.lat1);var cos1=Math.cos(this.lat1);var ms1=common.msfnz(this.e,sin1,cos1);var ts1=common.tsfnz(this.e,this.lat1,sin1);var sin2=Math.sin(this.lat2);var cos2=Math.cos(this.lat2);var ms2=common.msfnz(this.e,sin2,cos2);var ts2=common.tsfnz(this.e,this.lat2,sin2);var ts0=common.tsfnz(this.e,this.lat0,Math.sin(this.lat0));if(Math.abs(this.lat1-this.lat2)>common.EPSLN){this.ns=Math.log(ms1/ms2)/Math.log(ts1/ts2)}else{this.ns=sin1}if(isNaN(this.ns)){this.ns=sin1}this.f0=ms1/(this.ns*Math.pow(ts1,this.ns));this.rh=this.a*this.f0*Math.pow(ts0,this.ns);if(!this.title){this.title="Lambert Conformal Conic"}};exports.forward=function(p){var lon=p.x;var lat=p.y;if(Math.abs(2*Math.abs(lat)-common.PI)<=common.EPSLN){lat=common.sign(lat)*(common.HALF_PI-2*common.EPSLN)}var con=Math.abs(Math.abs(lat)-common.HALF_PI);var ts,rh1;if(con>common.EPSLN){ts=common.tsfnz(this.e,lat,Math.sin(lat));rh1=this.a*this.f0*Math.pow(ts,this.ns)}else{con=lat*this.ns;if(con<=0){return null}rh1=0}var theta=this.ns*common.adjust_lon(lon-this.long0);p.x=this.k0*rh1*Math.sin(theta)+this.x0;p.y=this.k0*(this.rh-rh1*Math.cos(theta))+this.y0;return p};exports.inverse=function(p){var rh1,con,ts;var lat,lon;var x=(p.x-this.x0)/this.k0;var y=this.rh-(p.y-this.y0)/this.k0;if(this.ns>0){rh1=Math.sqrt(x*x+y*y);con=1}else{rh1=-Math.sqrt(x*x+y*y);con=-1}var theta=0;if(rh1!==0){theta=Math.atan2(con*x,con*y)}if(rh1!==0||this.ns>0){con=1/this.ns;ts=Math.pow(rh1/(this.a*this.f0),con);lat=common.phi2z(this.e,ts);if(lat===-9999){return null}}else{lat=-common.HALF_PI}lon=common.adjust_lon(theta/this.ns+this.long0);p.x=lon;p.y=lat;return p};exports.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common":9}],36:[function(require,module,exports){exports.init=function(){};function identity(pt){return pt}exports.forward=identity;exports.inverse=identity;exports.names=["longlat","identity"]},{}],37:[function(require,module,exports){var common=require("../common");exports.init=function(){var con=this.b/this.a;this.es=1-con*con;this.e=Math.sqrt(this.es);if(this.lat_ts){if(this.sphere){this.k0=Math.cos(this.lat_ts)}else{this.k0=common.msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))}}else{if(!this.k0){if(this.k){this.k0=this.k}else{this.k0=1}}}};exports.forward=function(p){var lon=p.x;var lat=p.y;if(lat*common.R2D>90&&lat*common.R2D<-90&&lon*common.R2D>180&&lon*common.R2D<-180){return null}var x,y;if(Math.abs(Math.abs(lat)-common.HALF_PI)<=common.EPSLN){return null}else{if(this.sphere){x=this.x0+this.a*this.k0*common.adjust_lon(lon-this.long0);y=this.y0+this.a*this.k0*Math.log(Math.tan(common.FORTPI+.5*lat))}else{var sinphi=Math.sin(lat);var ts=common.tsfnz(this.e,lat,sinphi);x=this.x0+this.a*this.k0*common.adjust_lon(lon-this.long0);y=this.y0-this.a*this.k0*Math.log(ts)}p.x=x;p.y=y;return p}};exports.inverse=function(p){var x=p.x-this.x0;var y=p.y-this.y0;var lon,lat;if(this.sphere){lat=common.HALF_PI-2*Math.atan(Math.exp(-y/(this.a*this.k0)))}else{var ts=Math.exp(-y/(this.a*this.k0));lat=common.phi2z(this.e,ts);if(lat===-9999){return null}}lon=common.adjust_lon(this.long0+x/(this.a*this.k0));p.x=lon;p.y=lat;return p};exports.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common":9}],38:[function(require,module,exports){var common=require("../common");exports.init=function(){};exports.forward=function(p){var lon=p.x;var lat=p.y;var dlon=common.adjust_lon(lon-this.long0);var x=this.x0+this.a*dlon;var y=this.y0+this.a*Math.log(Math.tan(common.PI/4+lat/2.5))*1.25;p.x=x;p.y=y;return p};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var lon=common.adjust_lon(this.long0+p.x/this.a);var lat=2.5*(Math.atan(Math.exp(.8*p.y/this.a))-common.PI/4);p.x=lon;p.y=lat;return p};exports.names=["Miller_Cylindrical","mill"]},{"../common":9}],39:[function(require,module,exports){var common=require("../common");exports.init=function(){};exports.forward=function(p){var lon=p.x;var lat=p.y;var delta_lon=common.adjust_lon(lon-this.long0);var theta=lat;var con=common.PI*Math.sin(lat);for(var i=0;true;i++){var delta_theta=-(theta+Math.sin(theta)-con)/(1+Math.cos(theta));theta+=delta_theta;if(Math.abs(delta_theta)<common.EPSLN){break}}theta/=2;if(common.PI/2-Math.abs(lat)<common.EPSLN){delta_lon=0}var x=.900316316158*this.a*delta_lon*Math.cos(theta)+this.x0;var y=1.4142135623731*this.a*Math.sin(theta)+this.y0;p.x=x;p.y=y;return p};exports.inverse=function(p){var theta;var arg;p.x-=this.x0;p.y-=this.y0;arg=p.y/(1.4142135623731*this.a);if(Math.abs(arg)>.999999999999){arg=.999999999999}theta=Math.asin(arg);var lon=common.adjust_lon(this.long0+p.x/(.900316316158*this.a*Math.cos(theta)));if(lon<-common.PI){lon=-common.PI}if(lon>common.PI){lon=common.PI}arg=(2*theta+Math.sin(2*theta))/common.PI;if(Math.abs(arg)>1){arg=1}var lat=Math.asin(arg);p.x=lon;p.y=lat;return p};exports.names=["Mollweide","moll"]},{"../common":9}],40:[function(require,module,exports){var common=require("../common");exports.iterations=1;exports.init=function(){this.A=[];this.A[1]=.6399175073;this.A[2]=-.1358797613;this.A[3]=.063294409;this.A[4]=-.02526853;this.A[5]=.0117879;this.A[6]=-.0055161;this.A[7]=.0026906;this.A[8]=-.001333;this.A[9]=67e-5;this.A[10]=-34e-5;this.B_re=[];this.B_im=[];this.B_re[1]=.7557853228;this.B_im[1]=0;this.B_re[2]=.249204646;this.B_im[2]=.003371507;this.B_re[3]=-.001541739;this.B_im[3]=.04105856;this.B_re[4]=-.10162907;this.B_im[4]=.01727609;this.B_re[5]=-.26623489;this.B_im[5]=-.36249218;this.B_re[6]=-.6870983;this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-.577245789;this.C_im[2]=-.007809598;this.C_re[3]=.508307513;this.C_im[3]=-.112208952;this.C_re[4]=-.15094762;this.C_im[4]=.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=.5185406398;this.D[3]=-.03333098;this.D[4]=-.1052906;this.D[5]=-.0368594;this.D[6]=.007317;this.D[7]=.0122;this.D[8]=.00394;this.D[9]=-.0013};exports.forward=function(p){var n;var lon=p.x;var lat=p.y;var delta_lat=lat-this.lat0;var delta_lon=lon-this.long0;var d_phi=delta_lat/common.SEC_TO_RAD*1e-5;var d_lambda=delta_lon;var d_phi_n=1;var d_psi=0;for(n=1;n<=10;n++){d_phi_n=d_phi_n*d_phi;d_psi=d_psi+this.A[n]*d_phi_n}var th_re=d_psi;var th_im=d_lambda;var th_n_re=1;var th_n_im=0;var th_n_re1;var th_n_im1;var z_re=0;var z_im=0;for(n=1;n<=6;n++){th_n_re1=th_n_re*th_re-th_n_im*th_im;th_n_im1=th_n_im*th_re+th_n_re*th_im;th_n_re=th_n_re1;th_n_im=th_n_im1;z_re=z_re+this.B_re[n]*th_n_re-this.B_im[n]*th_n_im;z_im=z_im+this.B_im[n]*th_n_re+this.B_re[n]*th_n_im}p.x=z_im*this.a+this.x0;p.y=z_re*this.a+this.y0;return p};exports.inverse=function(p){var n;var x=p.x;var y=p.y;var delta_x=x-this.x0;var delta_y=y-this.y0;var z_re=delta_y/this.a;var z_im=delta_x/this.a;var z_n_re=1;var z_n_im=0;var z_n_re1;var z_n_im1;var th_re=0;var th_im=0;for(n=1;n<=6;n++){z_n_re1=z_n_re*z_re-z_n_im*z_im;z_n_im1=z_n_im*z_re+z_n_re*z_im;z_n_re=z_n_re1;z_n_im=z_n_im1;th_re=th_re+this.C_re[n]*z_n_re-this.C_im[n]*z_n_im;th_im=th_im+this.C_im[n]*z_n_re+this.C_re[n]*z_n_im}for(var i=0;i<this.iterations;i++){var th_n_re=th_re;var th_n_im=th_im;var th_n_re1;var th_n_im1;var num_re=z_re;var num_im=z_im;for(n=2;n<=6;n++){th_n_re1=th_n_re*th_re-th_n_im*th_im;th_n_im1=th_n_im*th_re+th_n_re*th_im;th_n_re=th_n_re1;th_n_im=th_n_im1;num_re=num_re+(n-1)*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im);num_im=num_im+(n-1)*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im)}th_n_re=1;th_n_im=0;var den_re=this.B_re[1];var den_im=this.B_im[1];for(n=2;n<=6;n++){th_n_re1=th_n_re*th_re-th_n_im*th_im;th_n_im1=th_n_im*th_re+th_n_re*th_im;th_n_re=th_n_re1;th_n_im=th_n_im1;den_re=den_re+n*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im);den_im=den_im+n*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im)}var den2=den_re*den_re+den_im*den_im;th_re=(num_re*den_re+num_im*den_im)/den2;th_im=(num_im*den_re-num_re*den_im)/den2}var d_psi=th_re;var d_lambda=th_im;var d_psi_n=1;var d_phi=0;for(n=1;n<=9;n++){d_psi_n=d_psi_n*d_psi;d_phi=d_phi+this.D[n]*d_psi_n}var lat=this.lat0+d_phi*common.SEC_TO_RAD*1e5;var lon=this.long0+d_lambda;p.x=lon;p.y=lat;return p};exports.names=["New_Zealand_Map_Grid","nzmg"]},{"../common":9}],41:[function(require,module,exports){var common=require("../common");exports.init=function(){this.no_off=this.no_off||false;this.no_rot=this.no_rot||false;if(isNaN(this.k0)){this.k0=1}var sinlat=Math.sin(this.lat0);var coslat=Math.cos(this.lat0);var con=this.e*sinlat;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(coslat,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-con*con);var t0=common.tsfnz(this.e,this.lat0,sinlat);var dl=this.bl/coslat*Math.sqrt((1-this.es)/(1-con*con));if(dl*dl<1){dl=1}var fl;var gl;if(!isNaN(this.longc)){if(this.lat0>=0){fl=dl+Math.sqrt(dl*dl-1)}else{fl=dl-Math.sqrt(dl*dl-1)}this.el=fl*Math.pow(t0,this.bl);gl=.5*(fl-1/fl);this.gamma0=Math.asin(Math.sin(this.alpha)/dl);this.long0=this.longc-Math.asin(gl*Math.tan(this.gamma0))/this.bl}else{var t1=common.tsfnz(this.e,this.lat1,Math.sin(this.lat1));var t2=common.tsfnz(this.e,this.lat2,Math.sin(this.lat2));if(this.lat0>=0){this.el=(dl+Math.sqrt(dl*dl-1))*Math.pow(t0,this.bl)}else{this.el=(dl-Math.sqrt(dl*dl-1))*Math.pow(t0,this.bl)}var hl=Math.pow(t1,this.bl);var ll=Math.pow(t2,this.bl);fl=this.el/hl;gl=.5*(fl-1/fl);var jl=(this.el*this.el-ll*hl)/(this.el*this.el+ll*hl);var pl=(ll-hl)/(ll+hl);var dlon12=common.adjust_lon(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(jl*Math.tan(.5*this.bl*dlon12)/pl)/this.bl;this.long0=common.adjust_lon(this.long0);var dlon10=common.adjust_lon(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*dlon10)/gl);this.alpha=Math.asin(dl*Math.sin(this.gamma0))}if(this.no_off){this.uc=0}else{if(this.lat0>=0){this.uc=this.al/this.bl*Math.atan2(Math.sqrt(dl*dl-1),Math.cos(this.alpha))}else{this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(dl*dl-1),Math.cos(this.alpha))}}};exports.forward=function(p){var lon=p.x;var lat=p.y;var dlon=common.adjust_lon(lon-this.long0);var us,vs;var con;if(Math.abs(Math.abs(lat)-common.HALF_PI)<=common.EPSLN){if(lat>0){con=-1}else{con=1}vs=this.al/this.bl*Math.log(Math.tan(common.FORTPI+con*this.gamma0*.5));us=-1*con*common.HALF_PI*this.al/this.bl}else{var t=common.tsfnz(this.e,lat,Math.sin(lat));var ql=this.el/Math.pow(t,this.bl);var sl=.5*(ql-1/ql);var tl=.5*(ql+1/ql);var vl=Math.sin(this.bl*dlon);var ul=(sl*Math.sin(this.gamma0)-vl*Math.cos(this.gamma0))/tl;if(Math.abs(Math.abs(ul)-1)<=common.EPSLN){vs=Number.POSITIVE_INFINITY}else{vs=.5*this.al*Math.log((1-ul)/(1+ul))/this.bl}if(Math.abs(Math.cos(this.bl*dlon))<=common.EPSLN){us=this.al*this.bl*dlon}else{us=this.al*Math.atan2(sl*Math.cos(this.gamma0)+vl*Math.sin(this.gamma0),Math.cos(this.bl*dlon))/this.bl}}if(this.no_rot){p.x=this.x0+us;p.y=this.y0+vs}else{us-=this.uc;p.x=this.x0+vs*Math.cos(this.alpha)+us*Math.sin(this.alpha);p.y=this.y0+us*Math.cos(this.alpha)-vs*Math.sin(this.alpha)}return p};exports.inverse=function(p){var us,vs;if(this.no_rot){vs=p.y-this.y0;us=p.x-this.x0}else{vs=(p.x-this.x0)*Math.cos(this.alpha)-(p.y-this.y0)*Math.sin(this.alpha);us=(p.y-this.y0)*Math.cos(this.alpha)+(p.x-this.x0)*Math.sin(this.alpha);us+=this.uc}var qp=Math.exp(-1*this.bl*vs/this.al);var sp=.5*(qp-1/qp);var tp=.5*(qp+1/qp);var vp=Math.sin(this.bl*us/this.al);var up=(vp*Math.cos(this.gamma0)+sp*Math.sin(this.gamma0))/tp;var ts=Math.pow(this.el/Math.sqrt((1+up)/(1-up)),1/this.bl);if(Math.abs(up-1)<common.EPSLN){p.x=this.long0;p.y=common.HALF_PI}else if(Math.abs(up+1)<common.EPSLN){p.x=this.long0;p.y=-1*common.HALF_PI}else{p.y=common.phi2z(this.e,ts);p.x=common.adjust_lon(this.long0-Math.atan2(sp*Math.cos(this.gamma0)-vp*Math.sin(this.gamma0),Math.cos(this.bl*us/this.al))/this.bl)}return p};exports.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common":9}],42:[function(require,module,exports){var common=require("../common");exports.init=function(){this.temp=this.b/this.a;this.es=1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=common.e0fn(this.es);this.e1=common.e1fn(this.es);this.e2=common.e2fn(this.es);this.e3=common.e3fn(this.es);this.ml0=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)};exports.forward=function(p){var lon=p.x;var lat=p.y;var x,y,el;var dlon=common.adjust_lon(lon-this.long0);el=dlon*Math.sin(lat);if(this.sphere){if(Math.abs(lat)<=common.EPSLN){x=this.a*dlon;y=-1*this.a*this.lat0}else{x=this.a*Math.sin(el)/Math.tan(lat);y=this.a*(common.adjust_lat(lat-this.lat0)+(1-Math.cos(el))/Math.tan(lat))}}else{if(Math.abs(lat)<=common.EPSLN){x=this.a*dlon;y=-1*this.ml0}else{var nl=common.gN(this.a,this.e,Math.sin(lat))/Math.tan(lat);x=nl*Math.sin(el);y=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,lat)-this.ml0+nl*(1-Math.cos(el))}}p.x=x+this.x0;p.y=y+this.y0;return p};exports.inverse=function(p){var lon,lat,x,y,i;var al,bl;var phi,dphi;x=p.x-this.x0;y=p.y-this.y0;if(this.sphere){if(Math.abs(y+this.a*this.lat0)<=common.EPSLN){lon=common.adjust_lon(x/this.a+this.long0);lat=0}else{al=this.lat0+y/this.a;bl=x*x/this.a/this.a+al*al;phi=al;var tanphi;for(i=common.MAX_ITER;i;--i){tanphi=Math.tan(phi);dphi=-1*(al*(phi*tanphi+1)-phi-.5*(phi*phi+bl)*tanphi)/((phi-al)/tanphi-1);phi+=dphi;if(Math.abs(dphi)<=common.EPSLN){lat=phi;break}}lon=common.adjust_lon(this.long0+Math.asin(x*Math.tan(phi)/this.a)/Math.sin(lat))}}else{if(Math.abs(y+this.ml0)<=common.EPSLN){lat=0;lon=common.adjust_lon(this.long0+x/this.a)}else{al=(this.ml0+y)/this.a;bl=x*x/this.a/this.a+al*al;phi=al;var cl,mln,mlnp,ma;var con;for(i=common.MAX_ITER;i;--i){con=this.e*Math.sin(phi);cl=Math.sqrt(1-con*con)*Math.tan(phi);mln=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,phi);mlnp=this.e0-2*this.e1*Math.cos(2*phi)+4*this.e2*Math.cos(4*phi)-6*this.e3*Math.cos(6*phi);ma=mln/this.a;dphi=(al*(cl*ma+1)-ma-.5*cl*(ma*ma+bl))/(this.es*Math.sin(2*phi)*(ma*ma+bl-2*al*ma)/(4*cl)+(al-ma)*(cl*mlnp-2/Math.sin(2*phi))-mlnp);phi-=dphi;if(Math.abs(dphi)<=common.EPSLN){lat=phi;break}}cl=Math.sqrt(1-this.es*Math.pow(Math.sin(lat),2))*Math.tan(lat);lon=common.adjust_lon(this.long0+Math.asin(x*cl/this.a)/Math.sin(lat))}}p.x=lon;p.y=lat;return p};exports.names=["Polyconic","poly"]},{"../common":9}],43:[function(require,module,exports){var common=require("../common");exports.init=function(){if(!this.sphere){this.en=common.pj_enfn(this.es)}else{this.n=1;this.m=0;this.es=0;this.C_y=Math.sqrt((this.m+1)/this.n);this.C_x=this.C_y/(this.m+1)}};exports.forward=function(p){var x,y;var lon=p.x;var lat=p.y;lon=common.adjust_lon(lon-this.long0);if(this.sphere){if(!this.m){lat=this.n!==1?Math.asin(this.n*Math.sin(lat)):lat}else{var k=this.n*Math.sin(lat);for(var i=common.MAX_ITER;i;--i){var V=(this.m*lat+Math.sin(lat)-k)/(this.m+Math.cos(lat));lat-=V;if(Math.abs(V)<common.EPSLN){break}}}x=this.a*this.C_x*lon*(this.m+Math.cos(lat));y=this.a*this.C_y*lat}else{var s=Math.sin(lat);var c=Math.cos(lat);y=this.a*common.pj_mlfn(lat,s,c,this.en);x=this.a*lon*c/Math.sqrt(1-this.es*s*s)}p.x=x;p.y=y;return p};exports.inverse=function(p){var lat,temp,lon,s;p.x-=this.x0;lon=p.x/this.a;p.y-=this.y0;lat=p.y/this.a;if(this.sphere){lat/=this.C_y;lon=lon/(this.C_x*(this.m+Math.cos(lat)));if(this.m){lat=common.asinz((this.m*lat+Math.sin(lat))/this.n)
}else if(this.n!==1){lat=common.asinz(Math.sin(lat)/this.n)}lon=common.adjust_lon(lon+this.long0);lat=common.adjust_lat(lat)}else{lat=common.pj_inv_mlfn(p.y/this.a,this.es,this.en);s=Math.abs(lat);if(s<common.HALF_PI){s=Math.sin(lat);temp=this.long0+p.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(lat));lon=common.adjust_lon(temp)}else if(s-common.EPSLN<common.HALF_PI){lon=this.long0}}p.x=lon;p.y=lat;return p};exports.names=["Sinusoidal","sinu"]},{"../common":9}],44:[function(require,module,exports){exports.init=function(){var phy0=this.lat0;this.lambda0=this.long0;var sinPhy0=Math.sin(phy0);var semiMajorAxis=this.a;var invF=this.rf;var flattening=1/invF;var e2=2*flattening-Math.pow(flattening,2);var e=this.e=Math.sqrt(e2);this.R=this.k0*semiMajorAxis*Math.sqrt(1-e2)/(1-e2*Math.pow(sinPhy0,2));this.alpha=Math.sqrt(1+e2/(1-e2)*Math.pow(Math.cos(phy0),4));this.b0=Math.asin(sinPhy0/this.alpha);var k1=Math.log(Math.tan(Math.PI/4+this.b0/2));var k2=Math.log(Math.tan(Math.PI/4+phy0/2));var k3=Math.log((1+e*sinPhy0)/(1-e*sinPhy0));this.K=k1-this.alpha*k2+this.alpha*e/2*k3};exports.forward=function(p){var Sa1=Math.log(Math.tan(Math.PI/4-p.y/2));var Sa2=this.e/2*Math.log((1+this.e*Math.sin(p.y))/(1-this.e*Math.sin(p.y)));var S=-this.alpha*(Sa1+Sa2)+this.K;var b=2*(Math.atan(Math.exp(S))-Math.PI/4);var I=this.alpha*(p.x-this.lambda0);var rotI=Math.atan(Math.sin(I)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(I)));var rotB=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(I));p.y=this.R/2*Math.log((1+Math.sin(rotB))/(1-Math.sin(rotB)))+this.y0;p.x=this.R*rotI+this.x0;return p};exports.inverse=function(p){var Y=p.x-this.x0;var X=p.y-this.y0;var rotI=Y/this.R;var rotB=2*(Math.atan(Math.exp(X/this.R))-Math.PI/4);var b=Math.asin(Math.cos(this.b0)*Math.sin(rotB)+Math.sin(this.b0)*Math.cos(rotB)*Math.cos(rotI));var I=Math.atan(Math.sin(rotI)/(Math.cos(this.b0)*Math.cos(rotI)-Math.sin(this.b0)*Math.tan(rotB)));var lambda=this.lambda0+I/this.alpha;var S=0;var phy=b;var prevPhy=-1e3;var iteration=0;while(Math.abs(phy-prevPhy)>1e-7){if(++iteration>20){return}S=1/this.alpha*(Math.log(Math.tan(Math.PI/4+b/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(phy))/2));prevPhy=phy;phy=2*Math.atan(Math.exp(S))-Math.PI/2}p.x=lambda;p.y=phy;return p};exports.names=["somerc"]},{}],45:[function(require,module,exports){var common=require("../common");exports.ssfn_=function(phit,sinphi,eccen){sinphi*=eccen;return Math.tan(.5*(common.HALF_PI+phit))*Math.pow((1-sinphi)/(1+sinphi),.5*eccen)};exports.init=function(){this.coslat0=Math.cos(this.lat0);this.sinlat0=Math.sin(this.lat0);if(this.sphere){if(this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=common.EPSLN){this.k0=.5*(1+common.sign(this.lat0)*Math.sin(this.lat_ts))}}else{if(Math.abs(this.coslat0)<=common.EPSLN){if(this.lat0>0){this.con=1}else{this.con=-1}}this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e));if(this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=common.EPSLN){this.k0=.5*this.cons*common.msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/common.tsfnz(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))}this.ms1=common.msfnz(this.e,this.sinlat0,this.coslat0);this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-common.HALF_PI;this.cosX0=Math.cos(this.X0);this.sinX0=Math.sin(this.X0)}};exports.forward=function(p){var lon=p.x;var lat=p.y;var sinlat=Math.sin(lat);var coslat=Math.cos(lat);var A,X,sinX,cosX,ts,rh;var dlon=common.adjust_lon(lon-this.long0);if(Math.abs(Math.abs(lon-this.long0)-common.PI)<=common.EPSLN&&Math.abs(lat+this.lat0)<=common.EPSLN){p.x=NaN;p.y=NaN;return p}if(this.sphere){A=2*this.k0/(1+this.sinlat0*sinlat+this.coslat0*coslat*Math.cos(dlon));p.x=this.a*A*coslat*Math.sin(dlon)+this.x0;p.y=this.a*A*(this.coslat0*sinlat-this.sinlat0*coslat*Math.cos(dlon))+this.y0;return p}else{X=2*Math.atan(this.ssfn_(lat,sinlat,this.e))-common.HALF_PI;cosX=Math.cos(X);sinX=Math.sin(X);if(Math.abs(this.coslat0)<=common.EPSLN){ts=common.tsfnz(this.e,lat*this.con,this.con*sinlat);rh=2*this.a*this.k0*ts/this.cons;p.x=this.x0+rh*Math.sin(lon-this.long0);p.y=this.y0-this.con*rh*Math.cos(lon-this.long0);return p}else if(Math.abs(this.sinlat0)<common.EPSLN){A=2*this.a*this.k0/(1+cosX*Math.cos(dlon));p.y=A*sinX}else{A=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*sinX+this.cosX0*cosX*Math.cos(dlon)));p.y=A*(this.cosX0*sinX-this.sinX0*cosX*Math.cos(dlon))+this.y0}p.x=A*cosX*Math.sin(dlon)+this.x0}return p};exports.inverse=function(p){p.x-=this.x0;p.y-=this.y0;var lon,lat,ts,ce,Chi;var rh=Math.sqrt(p.x*p.x+p.y*p.y);if(this.sphere){var c=2*Math.atan(rh/(.5*this.a*this.k0));lon=this.long0;lat=this.lat0;if(rh<=common.EPSLN){p.x=lon;p.y=lat;return p}lat=Math.asin(Math.cos(c)*this.sinlat0+p.y*Math.sin(c)*this.coslat0/rh);if(Math.abs(this.coslat0)<common.EPSLN){if(this.lat0>0){lon=common.adjust_lon(this.long0+Math.atan2(p.x,-1*p.y))}else{lon=common.adjust_lon(this.long0+Math.atan2(p.x,p.y))}}else{lon=common.adjust_lon(this.long0+Math.atan2(p.x*Math.sin(c),rh*this.coslat0*Math.cos(c)-p.y*this.sinlat0*Math.sin(c)))}p.x=lon;p.y=lat;return p}else{if(Math.abs(this.coslat0)<=common.EPSLN){if(rh<=common.EPSLN){lat=this.lat0;lon=this.long0;p.x=lon;p.y=lat;return p}p.x*=this.con;p.y*=this.con;ts=rh*this.cons/(2*this.a*this.k0);lat=this.con*common.phi2z(this.e,ts);lon=this.con*common.adjust_lon(this.con*this.long0+Math.atan2(p.x,-1*p.y))}else{ce=2*Math.atan(rh*this.cosX0/(2*this.a*this.k0*this.ms1));lon=this.long0;if(rh<=common.EPSLN){Chi=this.X0}else{Chi=Math.asin(Math.cos(ce)*this.sinX0+p.y*Math.sin(ce)*this.cosX0/rh);lon=common.adjust_lon(this.long0+Math.atan2(p.x*Math.sin(ce),rh*this.cosX0*Math.cos(ce)-p.y*this.sinX0*Math.sin(ce)))}lat=-1*common.phi2z(this.e,Math.tan(.5*(common.HALF_PI+Chi)))}}p.x=lon;p.y=lat;return p};exports.names=["stere"]},{"../common":9}],46:[function(require,module,exports){var common=require("../common");var gauss=require("./gauss");exports.init=function(){gauss.init.apply(this);if(!this.rc){return}this.sinc0=Math.sin(this.phic0);this.cosc0=Math.cos(this.phic0);this.R2=2*this.rc;if(!this.title){this.title="Oblique Stereographic Alternative"}};exports.forward=function(p){var sinc,cosc,cosl,k;p.x=common.adjust_lon(p.x-this.long0);gauss.forward.apply(this,[p]);sinc=Math.sin(p.y);cosc=Math.cos(p.y);cosl=Math.cos(p.x);k=this.k0*this.R2/(1+this.sinc0*sinc+this.cosc0*cosc*cosl);p.x=k*cosc*Math.sin(p.x);p.y=k*(this.cosc0*sinc-this.sinc0*cosc*cosl);p.x=this.a*p.x+this.x0;p.y=this.a*p.y+this.y0;return p};exports.inverse=function(p){var sinc,cosc,lon,lat,rho;p.x=(p.x-this.x0)/this.a;p.y=(p.y-this.y0)/this.a;p.x/=this.k0;p.y/=this.k0;if(rho=Math.sqrt(p.x*p.x+p.y*p.y)){var c=2*Math.atan2(rho,this.R2);sinc=Math.sin(c);cosc=Math.cos(c);lat=Math.asin(cosc*this.sinc0+p.y*sinc*this.cosc0/rho);lon=Math.atan2(p.x*sinc,rho*this.cosc0*cosc-p.y*this.sinc0*sinc)}else{lat=this.phic0;lon=0}p.x=lon;p.y=lat;gauss.inverse.apply(this,[p]);p.x=common.adjust_lon(p.x+this.long0);return p};exports.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common":9,"./gauss":30}],47:[function(require,module,exports){var common=require("../common");exports.init=function(){this.e0=common.e0fn(this.es);this.e1=common.e1fn(this.es);this.e2=common.e2fn(this.es);this.e3=common.e3fn(this.es);this.ml0=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)};exports.forward=function(p){var lon=p.x;var lat=p.y;var delta_lon=common.adjust_lon(lon-this.long0);var con;var x,y;var sin_phi=Math.sin(lat);var cos_phi=Math.cos(lat);if(this.sphere){var b=cos_phi*Math.sin(delta_lon);if(Math.abs(Math.abs(b)-1)<1e-10){return 93}else{x=.5*this.a*this.k0*Math.log((1+b)/(1-b));con=Math.acos(cos_phi*Math.cos(delta_lon)/Math.sqrt(1-b*b));if(lat<0){con=-con}y=this.a*this.k0*(con-this.lat0)}}else{var al=cos_phi*delta_lon;var als=Math.pow(al,2);var c=this.ep2*Math.pow(cos_phi,2);var tq=Math.tan(lat);var t=Math.pow(tq,2);con=1-this.es*Math.pow(sin_phi,2);var n=this.a/Math.sqrt(con);var ml=this.a*common.mlfn(this.e0,this.e1,this.e2,this.e3,lat);x=this.k0*n*al*(1+als/6*(1-t+c+als/20*(5-18*t+Math.pow(t,2)+72*c-58*this.ep2)))+this.x0;y=this.k0*(ml-this.ml0+n*tq*als*(.5+als/24*(5-t+9*c+4*Math.pow(c,2)+als/30*(61-58*t+Math.pow(t,2)+600*c-330*this.ep2))))+this.y0}p.x=x;p.y=y;return p};exports.inverse=function(p){var con,phi;var delta_phi;var i;var max_iter=6;var lat,lon;if(this.sphere){var f=Math.exp(p.x/(this.a*this.k0));var g=.5*(f-1/f);var temp=this.lat0+p.y/(this.a*this.k0);var h=Math.cos(temp);con=Math.sqrt((1-h*h)/(1+g*g));lat=common.asinz(con);if(temp<0){lat=-lat}if(g===0&&h===0){lon=this.long0}else{lon=common.adjust_lon(Math.atan2(g,h)+this.long0)}}else{var x=p.x-this.x0;var y=p.y-this.y0;con=(this.ml0+y/this.k0)/this.a;phi=con;for(i=0;true;i++){delta_phi=(con+this.e1*Math.sin(2*phi)-this.e2*Math.sin(4*phi)+this.e3*Math.sin(6*phi))/this.e0-phi;phi+=delta_phi;if(Math.abs(delta_phi)<=common.EPSLN){break}if(i>=max_iter){return 95}}if(Math.abs(phi)<common.HALF_PI){var sin_phi=Math.sin(phi);var cos_phi=Math.cos(phi);var tan_phi=Math.tan(phi);var c=this.ep2*Math.pow(cos_phi,2);var cs=Math.pow(c,2);var t=Math.pow(tan_phi,2);var ts=Math.pow(t,2);con=1-this.es*Math.pow(sin_phi,2);var n=this.a/Math.sqrt(con);var r=n*(1-this.es)/con;var d=x/(n*this.k0);var ds=Math.pow(d,2);lat=phi-n*tan_phi*ds/r*(.5-ds/24*(5+3*t+10*c-4*cs-9*this.ep2-ds/30*(61+90*t+298*c+45*ts-252*this.ep2-3*cs)));lon=common.adjust_lon(this.long0+d*(1-ds/6*(1+2*t+c-ds/20*(5-2*c+28*t-3*cs+8*this.ep2+24*ts)))/cos_phi)}else{lat=common.HALF_PI*common.sign(y);lon=this.long0}}p.x=lon;p.y=lat;return p};exports.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common":9}],48:[function(require,module,exports){var common=require("../common");var tmerc=require("./tmerc");exports.dependsOn="tmerc";exports.init=function(){if(!this.zone){return}this.lat0=0;this.long0=(6*Math.abs(this.zone)-183)*common.D2R;this.x0=5e5;this.y0=this.utmSouth?1e7:0;this.k0=.9996;tmerc.init.apply(this);this.forward=tmerc.forward;this.inverse=tmerc.inverse};exports.names=["Universal Transverse Mercator System","utm"]},{"../common":9,"./tmerc":47}],49:[function(require,module,exports){var common=require("../common");exports.init=function(){this.R=this.a};exports.forward=function(p){var lon=p.x;var lat=p.y;var dlon=common.adjust_lon(lon-this.long0);var x,y;if(Math.abs(lat)<=common.EPSLN){x=this.x0+this.R*dlon;y=this.y0}var theta=common.asinz(2*Math.abs(lat/common.PI));if(Math.abs(dlon)<=common.EPSLN||Math.abs(Math.abs(lat)-common.HALF_PI)<=common.EPSLN){x=this.x0;if(lat>=0){y=this.y0+common.PI*this.R*Math.tan(.5*theta)}else{y=this.y0+common.PI*this.R*-Math.tan(.5*theta)}}var al=.5*Math.abs(common.PI/dlon-dlon/common.PI);var asq=al*al;var sinth=Math.sin(theta);var costh=Math.cos(theta);var g=costh/(sinth+costh-1);var gsq=g*g;var m=g*(2/sinth-1);var msq=m*m;var con=common.PI*this.R*(al*(g-msq)+Math.sqrt(asq*(g-msq)*(g-msq)-(msq+asq)*(gsq-msq)))/(msq+asq);if(dlon<0){con=-con}x=this.x0+con;var q=asq+g;con=common.PI*this.R*(m*q-al*Math.sqrt((msq+asq)*(asq+1)-q*q))/(msq+asq);if(lat>=0){y=this.y0+con}else{y=this.y0-con}p.x=x;p.y=y;return p};exports.inverse=function(p){var lon,lat;var xx,yy,xys,c1,c2,c3;var a1;var m1;var con;var th1;var d;p.x-=this.x0;p.y-=this.y0;con=common.PI*this.R;xx=p.x/con;yy=p.y/con;xys=xx*xx+yy*yy;c1=-Math.abs(yy)*(1+xys);c2=c1-2*yy*yy+xx*xx;c3=-2*c1+1+2*yy*yy+xys*xys;d=yy*yy/c3+(2*c2*c2*c2/c3/c3/c3-9*c1*c2/c3/c3)/27;a1=(c1-c2*c2/3/c3)/c3;m1=2*Math.sqrt(-a1/3);con=3*d/a1/m1;if(Math.abs(con)>1){if(con>=0){con=1}else{con=-1}}th1=Math.acos(con)/3;if(p.y>=0){lat=(-m1*Math.cos(th1+common.PI/3)-c2/3/c3)*common.PI}else{lat=-(-m1*Math.cos(th1+common.PI/3)-c2/3/c3)*common.PI}if(Math.abs(xx)<common.EPSLN){lon=this.long0}else{lon=common.adjust_lon(this.long0+common.PI*(xys-1+Math.sqrt(1+2*(xx*xx-yy*yy)+xys*xys))/2/xx)}p.x=lon;p.y=lat;return p};exports.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common":9}],50:[function(require,module,exports){var common=require("./common");var datum_transform=require("./datum_transform");var adjust_axis=require("./adjust_axis");var proj=require("./Proj");module.exports=function transform(source,dest,point){var wgs84;function checkNotWGS(source,dest){return(source.datum.datum_type===common.PJD_3PARAM||source.datum.datum_type===common.PJD_7PARAM)&&dest.datumCode!=="WGS84"}if(source.datum&&dest.datum&&(checkNotWGS(source,dest)||checkNotWGS(dest,source))){wgs84=new proj("WGS84");transform(source,wgs84,point);source=wgs84}if(source.axis!=="enu"){adjust_axis(source,false,point)}if(source.projName==="longlat"){point.x*=common.D2R;point.y*=common.D2R}else{if(source.to_meter){point.x*=source.to_meter;point.y*=source.to_meter}source.inverse(point)}if(source.from_greenwich){point.x+=source.from_greenwich}point=datum_transform(source.datum,dest.datum,point);if(dest.from_greenwich){point.x-=dest.from_greenwich}if(dest.projName==="longlat"){point.x*=common.R2D;point.y*=common.R2D}else{dest.forward(point);if(dest.to_meter){point.x/=dest.to_meter;point.y/=dest.to_meter}}if(dest.axis!=="enu"){adjust_axis(dest,true,point)}return point}},{"./Proj":7,"./adjust_axis":8,"./common":9,"./datum_transform":17}],51:[function(require,module,exports){module.exports="2.0.0"},{}],52:[function(require,module,exports){var common=require("./common");var extend=require("./extend");function mapit(obj,key,v){obj[key]=v.map(function(aa){var o={};sExpr(aa,o);return o}).reduce(function(a,b){return extend(a,b)},{})}function sExpr(v,obj){var key;if(!Array.isArray(v)){obj[v]=true;return}else{key=v.shift();if(key==="PARAMETER"){key=v.shift()}if(v.length===1){if(Array.isArray(v[0])){obj[key]={};sExpr(v[0],obj[key])}else{obj[key]=v[0]}}else if(!v.length){obj[key]=true}else if(key==="TOWGS84"){obj[key]=v}else{obj[key]={};if(["UNIT","PRIMEM","VERT_DATUM"].indexOf(key)>-1){obj[key]={name:v[0].toLowerCase(),convert:v[1]};if(v.length===3){obj[key].auth=v[2]}}else if(key==="SPHEROID"){obj[key]={name:v[0],a:v[1],rf:v[2]};if(v.length===4){obj[key].auth=v[3]}}else if(["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(key)>-1){v[0]=["name",v[0]];mapit(obj,key,v)}else if(v.every(function(aa){return Array.isArray(aa)})){mapit(obj,key,v)}else{sExpr(v,obj[key])}}}}function rename(obj,params){var outName=params[0];var inName=params[1];if(!(outName in obj)&&inName in obj){obj[outName]=obj[inName];if(params.length===3){obj[outName]=params[2](obj[outName])}}}function d2r(input){return input*common.D2R}function cleanWKT(wkt){if(wkt.type==="GEOGCS"){wkt.projName="longlat"}else if(wkt.type==="LOCAL_CS"){wkt.projName="identity";wkt.local=true}else{if(typeof wkt.PROJECTION==="object"){wkt.projName=Object.keys(wkt.PROJECTION)[0]}else{wkt.projName=wkt.PROJECTION}}if(wkt.UNIT){wkt.units=wkt.UNIT.name.toLowerCase();if(wkt.units==="metre"){wkt.units="meter"}if(wkt.UNIT.convert){wkt.to_meter=parseFloat(wkt.UNIT.convert,10)}}if(wkt.GEOGCS){if(wkt.GEOGCS.DATUM){wkt.datumCode=wkt.GEOGCS.DATUM.name.toLowerCase()}else{wkt.datumCode=wkt.GEOGCS.name.toLowerCase()}if(wkt.datumCode.slice(0,2)==="d_"){wkt.datumCode=wkt.datumCode.slice(2)}if(wkt.datumCode==="new_zealand_geodetic_datum_1949"||wkt.datumCode==="new_zealand_1949"){wkt.datumCode="nzgd49"}if(wkt.datumCode==="wgs_1984"){if(wkt.PROJECTION==="Mercator_Auxiliary_Sphere"){wkt.sphere=true}wkt.datumCode="wgs84"}if(wkt.datumCode.slice(-6)==="_ferro"){wkt.datumCode=wkt.datumCode.slice(0,-6)}if(wkt.datumCode.slice(-8)==="_jakarta"){wkt.datumCode=wkt.datumCode.slice(0,-8)}if(wkt.GEOGCS.DATUM&&wkt.GEOGCS.DATUM.SPHEROID){wkt.ellps=wkt.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk");if(wkt.ellps.toLowerCase().slice(0,13)==="international"){wkt.ellps="intl"}wkt.a=wkt.GEOGCS.DATUM.SPHEROID.a;wkt.rf=parseFloat(wkt.GEOGCS.DATUM.SPHEROID.rf,10)}}if(wkt.b&&!isFinite(wkt.b)){wkt.b=wkt.a}function toMeter(input){var ratio=wkt.to_meter||1;return parseFloat(input,10)*ratio}var renamer=function(a){return rename(wkt,a)};var list=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",d2r],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",d2r],["x0","false_easting",toMeter],["y0","false_northing",toMeter],["long0","central_meridian",d2r],["lat0","latitude_of_origin",d2r],["lat0","standard_parallel_1",d2r],["lat1","standard_parallel_1",d2r],["lat2","standard_parallel_2",d2r],["alpha","azimuth",d2r],["srsCode","name"]];list.forEach(renamer);if(!wkt.long0&&wkt.longc&&(wkt.PROJECTION==="Albers_Conic_Equal_Area"||wkt.PROJECTION==="Lambert_Azimuthal_Equal_Area")){wkt.long0=wkt.longc}}module.exports=function(wkt,self){var lisp=JSON.parse((","+wkt).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]'));var type=lisp.shift();var name=lisp.shift();lisp.unshift(["name",name]);lisp.unshift(["type",type]);lisp.unshift("output");var obj={};sExpr(lisp,obj);cleanWKT(obj.output);return extend(self,obj.output)}},{"./common":9,"./extend":19}],53:[function(require,module,exports){(function(){"use strict";var _camelizeCssPropName=function(){var matcherRegex=/\-([a-z])/g,replacerFn=function(match,group){return group.toUpperCase()};return function(prop){return prop.replace(matcherRegex,replacerFn)}}();var _getStyle=function(el,prop){var value,camelProp,tagName,possiblePointers,i,len;if(window.getComputedStyle){value=window.getComputedStyle(el,null).getPropertyValue(prop)}else{camelProp=_camelizeCssPropName(prop);if(el.currentStyle){value=el.currentStyle[camelProp]}else{value=el.style[camelProp]}}if(prop==="cursor"){if(!value||value==="auto"){tagName=el.tagName.toLowerCase();possiblePointers=["a"];for(i=0,len=possiblePointers.length;i<len;i++){if(tagName===possiblePointers[i]){return"pointer"}}}}return value};var _elementMouseOver=function(event){if(!ZeroClipboard.prototype._singleton)return;if(!event){event=window.event}var target;if(this!==window){target=this}else if(event.target){target=event.target}else if(event.srcElement){target=event.srcElement}ZeroClipboard.prototype._singleton.setCurrent(target)};var _addEventHandler=function(element,method,func){if(element.addEventListener){element.addEventListener(method,func,false)}else if(element.attachEvent){element.attachEvent("on"+method,func)}};var _removeEventHandler=function(element,method,func){if(element.removeEventListener){element.removeEventListener(method,func,false)}else if(element.detachEvent){element.detachEvent("on"+method,func)}};var _addClass=function(element,value){if(element.addClass){element.addClass(value);return element}if(value&&typeof value==="string"){var classNames=(value||"").split(/\s+/);if(element.nodeType===1){if(!element.className){element.className=value}else{var className=" "+element.className+" ",setClass=element.className;for(var c=0,cl=classNames.length;c<cl;c++){if(className.indexOf(" "+classNames[c]+" ")<0){setClass+=" "+classNames[c]}}element.className=setClass.replace(/^\s+|\s+$/g,"")}}}return element};var _removeClass=function(element,value){if(element.removeClass){element.removeClass(value);return element}if(value&&typeof value==="string"||value===undefined){var classNames=(value||"").split(/\s+/);if(element.nodeType===1&&element.className){if(value){var className=(" "+element.className+" ").replace(/[\n\t]/g," ");for(var c=0,cl=classNames.length;c<cl;c++){className=className.replace(" "+classNames[c]+" "," ")}element.className=className.replace(/^\s+|\s+$/g,"")}else{element.className=""}}}return element};var _getZoomFactor=function(){var rect,physicalWidth,logicalWidth,zoomFactor=1;if(typeof document.body.getBoundingClientRect==="function"){rect=document.body.getBoundingClientRect();physicalWidth=rect.right-rect.left;logicalWidth=document.body.offsetWidth;zoomFactor=Math.round(physicalWidth/logicalWidth*100)/100}return zoomFactor};var _getDOMObjectPosition=function(obj){var info={left:0,top:0,width:0,height:0,zIndex:999999999};var zi=_getStyle(obj,"z-index");if(zi&&zi!=="auto"){info.zIndex=parseInt(zi,10)}if(obj.getBoundingClientRect){var rect=obj.getBoundingClientRect();var pageXOffset,pageYOffset,zoomFactor;if("pageXOffset"in window&&"pageYOffset"in window){pageXOffset=window.pageXOffset;pageYOffset=window.pageYOffset}else{zoomFactor=_getZoomFactor();pageXOffset=Math.round(document.documentElement.scrollLeft/zoomFactor);pageYOffset=Math.round(document.documentElement.scrollTop/zoomFactor)}var leftBorderWidth=document.documentElement.clientLeft||0;var topBorderWidth=document.documentElement.clientTop||0;info.left=rect.left+pageXOffset-leftBorderWidth;info.top=rect.top+pageYOffset-topBorderWidth;info.width="width"in rect?rect.width:rect.right-rect.left;info.height="height"in rect?rect.height:rect.bottom-rect.top}return info};var _noCache=function(path,options){var useNoCache=!(options&&options.useNoCache===false);if(useNoCache){return(path.indexOf("?")===-1?"?":"&")+"nocache="+(new Date).getTime()}else{return""}};var _vars=function(options){var str=[];var origins=[];if(options.trustedOrigins){if(typeof options.trustedOrigins==="string"){origins.push(options.trustedOrigins)}else if(typeof options.trustedOrigins==="object"&&"length"in options.trustedOrigins){origins=origins.concat(options.trustedOrigins)}}if(options.trustedDomains){if(typeof options.trustedDomains==="string"){origins.push(options.trustedDomains)}else if(typeof options.trustedDomains==="object"&&"length"in options.trustedDomains){origins=origins.concat(options.trustedDomains)}}if(origins.length){str.push("trustedOrigins="+encodeURIComponent(origins.join(",")))}if(typeof options.amdModuleId==="string"&&options.amdModuleId){str.push("amdModuleId="+encodeURIComponent(options.amdModuleId))}if(typeof options.cjsModuleId==="string"&&options.cjsModuleId){str.push("cjsModuleId="+encodeURIComponent(options.cjsModuleId))}return str.join("&")};var _inArray=function(elem,array){if(array.indexOf){return array.indexOf(elem)}for(var i=0,length=array.length;i<length;i++){if(array[i]===elem){return i}}return-1};var _prepGlue=function(elements){if(typeof elements==="string")throw new TypeError("ZeroClipboard doesn't accept query strings.");if(!elements.length)return[elements];return elements};var _dispatchCallback=function(func,element,instance,args,async){if(async){window.setTimeout(function(){func.call(element,instance,args)},0)}else{func.call(element,instance,args)}};var ZeroClipboard=function(elements,options){if(elements)(ZeroClipboard.prototype._singleton||this).glue(elements);if(ZeroClipboard.prototype._singleton)return ZeroClipboard.prototype._singleton;ZeroClipboard.prototype._singleton=this;this.options={};for(var kd in _defaults)this.options[kd]=_defaults[kd];for(var ko in options)this.options[ko]=options[ko];this.handlers={};if(ZeroClipboard.detectFlashSupport())_bridge()};var currentElement,gluedElements=[];ZeroClipboard.prototype.setCurrent=function(element){currentElement=element;this.reposition();var titleAttr=element.getAttribute("title");if(titleAttr){this.setTitle(titleAttr)}var useHandCursor=this.options.forceHandCursor===true||_getStyle(element,"cursor")==="pointer";_setHandCursor.call(this,useHandCursor);return this};ZeroClipboard.prototype.setText=function(newText){if(newText&&newText!==""){this.options.text=newText;if(this.ready())this.flashBridge.setText(newText)}return this};ZeroClipboard.prototype.setTitle=function(newTitle){if(newTitle&&newTitle!=="")this.htmlBridge.setAttribute("title",newTitle);return this};ZeroClipboard.prototype.setSize=function(width,height){if(this.ready())this.flashBridge.setSize(width,height);return this};ZeroClipboard.prototype.setHandCursor=function(enabled){enabled=typeof enabled==="boolean"?enabled:!!enabled;_setHandCursor.call(this,enabled);this.options.forceHandCursor=enabled;return this};var _setHandCursor=function(enabled){if(this.ready())this.flashBridge.setHandCursor(enabled)};ZeroClipboard.version="1.2.3";var _defaults={moviePath:"ZeroClipboard.swf",trustedOrigins:null,text:null,hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",allowScriptAccess:"sameDomain",useNoCache:true,forceHandCursor:false};ZeroClipboard.setDefaults=function(options){for(var ko in options)_defaults[ko]=options[ko]};ZeroClipboard.destroy=function(){ZeroClipboard.prototype._singleton.unglue(gluedElements);var bridge=ZeroClipboard.prototype._singleton.htmlBridge;bridge.parentNode.removeChild(bridge);delete ZeroClipboard.prototype._singleton};ZeroClipboard.detectFlashSupport=function(){var hasFlash=false;if(typeof ActiveXObject==="function"){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){hasFlash=true}}catch(error){}}if(!hasFlash&&navigator.mimeTypes["application/x-shockwave-flash"]){hasFlash=true}return hasFlash};var _amdModuleId=null;var _cjsModuleId=null;var _bridge=function(){var flashBridge,len;var client=ZeroClipboard.prototype._singleton;var container=document.getElementById("global-zeroclipboard-html-bridge");if(!container){var opts={};for(var ko in client.options)opts[ko]=client.options[ko];opts.amdModuleId=_amdModuleId;opts.cjsModuleId=_cjsModuleId;var flashvars=_vars(opts);var html='      <object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="global-zeroclipboard-flash-bridge" width="100%" height="100%">         <param name="movie" value="'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'"/>         <param name="allowScriptAccess" value="'+client.options.allowScriptAccess+'"/>         <param name="scale" value="exactfit"/>         <param name="loop" value="false"/>         <param name="menu" value="false"/>         <param name="quality" value="best" />         <param name="bgcolor" value="#ffffff"/>         <param name="wmode" value="transparent"/>         <param name="flashvars" value="'+flashvars+'"/>         <embed src="'+client.options.moviePath+_noCache(client.options.moviePath,client.options)+'"           loop="false" menu="false"           quality="best" bgcolor="#ffffff"           width="100%" height="100%"           name="global-zeroclipboard-flash-bridge"           allowScriptAccess="always"           allowFullScreen="false"           type="application/x-shockwave-flash"           wmode="transparent"           pluginspage="http://www.macromedia.com/go/getflashplayer"           flashvars="'+flashvars+'"           scale="exactfit">         </embed>       </object>';container=document.createElement("div");container.id="global-zeroclipboard-html-bridge";container.setAttribute("class","global-zeroclipboard-container");container.setAttribute("data-clipboard-ready",false);container.style.position="absolute";container.style.left="-9999px";container.style.top="-9999px";container.style.width="15px";container.style.height="15px";container.style.zIndex="9999";container.innerHTML=html;document.body.appendChild(container)}client.htmlBridge=container;flashBridge=document["global-zeroclipboard-flash-bridge"];if(flashBridge&&(len=flashBridge.length)){flashBridge=flashBridge[len-1]}client.flashBridge=flashBridge||container.children[0].lastElementChild};ZeroClipboard.prototype.resetBridge=function(){this.htmlBridge.style.left="-9999px";this.htmlBridge.style.top="-9999px";this.htmlBridge.removeAttribute("title");this.htmlBridge.removeAttribute("data-clipboard-text");_removeClass(currentElement,this.options.activeClass);currentElement=null;this.options.text=null;return this};ZeroClipboard.prototype.ready=function(){var ready=this.htmlBridge.getAttribute("data-clipboard-ready");return ready==="true"||ready===true};ZeroClipboard.prototype.reposition=function(){if(!currentElement)return false;var pos=_getDOMObjectPosition(currentElement);this.htmlBridge.style.top=pos.top+"px";this.htmlBridge.style.left=pos.left+"px";this.htmlBridge.style.width=pos.width+"px";this.htmlBridge.style.height=pos.height+"px";this.htmlBridge.style.zIndex=pos.zIndex+1;this.setSize(pos.width,pos.height);return this};ZeroClipboard.dispatch=function(eventName,args){ZeroClipboard.prototype._singleton.receiveEvent(eventName,args)};ZeroClipboard.prototype.on=function(eventName,func){var events=eventName.toString().split(/\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,"");if(!this.handlers[eventName])this.handlers[eventName]=func}if(this.handlers.noflash&&!ZeroClipboard.detectFlashSupport()){this.receiveEvent("onNoFlash",null)}return this};ZeroClipboard.prototype.addEventListener=ZeroClipboard.prototype.on;ZeroClipboard.prototype.off=function(eventName,func){var events=eventName.toString().split(/\s/g);for(var i=0;i<events.length;i++){eventName=events[i].toLowerCase().replace(/^on/,"");for(var event in this.handlers){if(event===eventName&&this.handlers[event]===func){delete this.handlers[event]}}}return this};ZeroClipboard.prototype.removeEventListener=ZeroClipboard.prototype.off;ZeroClipboard.prototype.receiveEvent=function(eventName,args){eventName=eventName.toString().toLowerCase().replace(/^on/,"");var element=currentElement;var performCallbackAsync=true;switch(eventName){case"load":if(args&&parseFloat(args.flashVersion.replace(",",".").replace(/[^0-9\.]/gi,""))<10){this.receiveEvent("onWrongFlash",{flashVersion:args.flashVersion});return}this.htmlBridge.setAttribute("data-clipboard-ready",true);break;case"mouseover":_addClass(element,this.options.hoverClass);break;case"mouseout":_removeClass(element,this.options.hoverClass);this.resetBridge();break;case"mousedown":_addClass(element,this.options.activeClass);break;case"mouseup":_removeClass(element,this.options.activeClass);break;case"datarequested":var targetId=element.getAttribute("data-clipboard-target"),targetEl=!targetId?null:document.getElementById(targetId);if(targetEl){var textContent=targetEl.value||targetEl.textContent||targetEl.innerText;if(textContent)this.setText(textContent)}else{var defaultText=element.getAttribute("data-clipboard-text");if(defaultText)this.setText(defaultText)}performCallbackAsync=false;break;case"complete":this.options.text=null;break}if(this.handlers[eventName]){var func=this.handlers[eventName];if(typeof func==="string"&&typeof window[func]==="function"){func=window[func]}if(typeof func==="function"){_dispatchCallback(func,element,this,args,performCallbackAsync)}}};ZeroClipboard.prototype.glue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){if(_inArray(elements[i],gluedElements)==-1){gluedElements.push(elements[i]);_addEventHandler(elements[i],"mouseover",_elementMouseOver)}}return this};ZeroClipboard.prototype.unglue=function(elements){elements=_prepGlue(elements);for(var i=0;i<elements.length;i++){_removeEventHandler(elements[i],"mouseover",_elementMouseOver);var arrayIndex=_inArray(elements[i],gluedElements);if(arrayIndex!=-1)gluedElements.splice(arrayIndex,1)}return this};if(typeof define==="function"&&define.amd){define(["require","exports","module"],function(require,exports,module){_amdModuleId=module&&module.id||null;return ZeroClipboard})}else if(typeof module==="object"&&module&&typeof module.exports==="object"&&module.exports){_cjsModuleId=module.id||null;module.exports=ZeroClipboard}else{window.ZeroClipboard=ZeroClipboard}})()},{}]},{},[3]);